<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HIFIR: LUP.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HIFIR
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('LUP_8hpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LUP.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="LUP_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//                  This file is part of the HIFIR library                   //</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * \file hif/small_scale/LUP.hpp</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * \brief Small scale solver with dense LU with partial pivoting</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * \author Qiao Chen</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">\verbatim</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">Copyright (C) 2021 NumGeom Group at Stony Brook University</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">it under the terms of the GNU Affero General Public License as published</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">by the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">(at your option) any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">GNU Affero General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">You should have received a copy of the GNU Affero General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">\endverbatim</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">ifndef</span> <span class="preprocessor">_HIF_SMALLSCALE_LUP_HPP</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">_HIF_SMALLSCALE_LUP_HPP</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">algorithm</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">array</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;hif/Options.h&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;hif/ds/Array.hpp&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;hif/ds/DenseMatrix.hpp&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;hif/small_scale/lapack.hpp&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">namespace</span> <a class="code" href="namespacehif.html">hif</a> {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/// \class LUP</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/// \brief LU with partial pivoting for small scale solver</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// \tparam ValueType value type, e.g. \a double</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">/// \ingroup sss</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ValueType&gt;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html">   47</a></span>&#160;<span class="keyword">class</span> <a class="code" href="classhif_1_1LUP.html">LUP</a> {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">   49</a></span>&#160;  <span class="keyword">typedef</span> ValueType                      <a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>;     <span class="comment">///&lt; value type</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">   50</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classhif_1_1DenseMatrix.html">DenseMatrix</a>&lt;<a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>&gt;        <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a>;     <span class="comment">///&lt; dense matrix</span></div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#abad2930b93568a959934c66f7ee46e6d">   51</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classhif_1_1Lapack.html">Lapack</a>&lt;<a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>&gt;             <a class="code" href="classhif_1_1LUP.html#abad2930b93568a959934c66f7ee46e6d">lapack_kernel</a>;  <span class="comment">///&lt; lapack backend</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">   52</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a>::<a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a>;      <span class="comment">///&lt; size type</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">/// \brief get the solver type</span></div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a54366070daa0e6d7714a270e1fa99d8f">   55</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classhif_1_1LUP.html#a54366070daa0e6d7714a270e1fa99d8f">method</a>() { <span class="keywordflow">return</span> <span class="stringliteral">&quot;LUP&quot;</span>; }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">/// \brief default constructor</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a6509a2d56b2855847939527905555ff2">   58</a></span>&#160;  <a class="code" href="classhif_1_1LUP.html#a6509a2d56b2855847939527905555ff2">LUP</a>() { <a class="code" href="classhif_1_1LUP.html#a9f4aee22640b511c62c6ada914a23cad">_rank</a> = 0u; }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// utilities</span></div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#ac0d4a8db299fe2e8ecf322533cbea470">   61</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span>              <a class="code" href="classhif_1_1LUP.html#ac0d4a8db299fe2e8ecf322533cbea470">empty</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.empty(); }</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#add6e2ce31ee34826ec61d20a56446e30">   62</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a>         <a class="code" href="classhif_1_1LUP.html#add6e2ce31ee34826ec61d20a56446e30">rank</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1LUP.html#a9f4aee22640b511c62c6ada914a23cad">_rank</a>; }</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a6adb5b3a405792d4ada25a6250debe04">   63</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a> &amp;<a class="code" href="classhif_1_1LUP.html#a6adb5b3a405792d4ada25a6250debe04">mat</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>; }</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a716caf44704926e00cb0dfb8c48f0a3e">   64</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a> &amp;      <a class="code" href="classhif_1_1LUP.html#a716caf44704926e00cb0dfb8c48f0a3e">mat</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>; }</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#aaa4e600c5b8cb4b4f324cfbf164d3d23">   65</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a> &amp;<a class="code" href="classhif_1_1LUP.html#aaa4e600c5b8cb4b4f324cfbf164d3d23">mat_backup</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>; }</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a0b004683a143aab89fdf4dd9c759a51b">   66</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a> &amp;      <a class="code" href="classhif_1_1LUP.html#a0b004683a143aab89fdf4dd9c759a51b">mat_backup</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>; }</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a5772b3b974679b5de484493c370f9751">   67</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span>              <a class="code" href="classhif_1_1LUP.html#a5772b3b974679b5de484493c370f9751">is_squared</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.is_squared(); }</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#aaa1fc034e4b243f909aaeb07717642f5">   68</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classhif_1_1LUP.html#aaa1fc034e4b243f909aaeb07717642f5">full_rank</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1LUP.html#a9f4aee22640b511c62c6ada914a23cad">_rank</a> != 0u &amp;&amp; <a class="code" href="classhif_1_1LUP.html#a9f4aee22640b511c62c6ada914a23cad">_rank</a> == <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.ncols(); }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">/// \brief set operator</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">/// \tparam CsType compressed storage type, see \ref CCS and \ref CRS</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">/// \param[in] cs compressed storage</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> CsType&gt;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a678c46c53224f0d8579a8766859d04b9">   74</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#a678c46c53224f0d8579a8766859d04b9">set_matrix</a>(<span class="keyword">const</span> CsType &amp;cs) {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a> = <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a>::from_sparse(cs);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.resize(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.nrows(), <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.ncols());</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    std::copy(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.array().cbegin(), <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.array().cend(),</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;              <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.array().begin());</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">/// \brief set a dense operator, this is needed for H version</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">/// \param[in,out] mat input matrix, the data is \b destroyed upon output</span></div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a523807c09323aeb2667ab13e10967f2d">   83</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#a523807c09323aeb2667ab13e10967f2d">set_matrix</a>(<a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a> &amp;&amp;mat) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a> = std::move(mat);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.resize(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.nrows(), <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.ncols());</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    std::copy(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.array().cbegin(), <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.array().cend(),</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;              <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.array().begin());</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">/// \brief set a dense operator from other data type</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">/// \tparam T value type</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a25383158334abea9d726f316c4bc4edc">   93</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#a25383158334abea9d726f316c4bc4edc">set_matrix</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1DenseMatrix.html">DenseMatrix</a>&lt;T&gt; &amp;mat) {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a> = <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a>(mat);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.resize(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.nrows(), <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.ncols());</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    std::copy(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.array().cbegin(), <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.array().cend(),</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;              <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.array().begin());</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">/// \brief perform LU with partial pivoting</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">/// \param[in] opts control parameters, see \ref Options</span></div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a8c2bef9ad4a5bcef602fdcd682c66683">  102</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#a8c2bef9ad4a5bcef602fdcd682c66683">factorize</a>(<span class="keyword">const</span> <a class="code" href="group__itr.html#ga8af676f52fa6072d6264436495d20772">Options</a> &amp;opts) {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.empty(), <span class="stringliteral">&quot;matrix is still empty!&quot;</span>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(!<a class="code" href="classhif_1_1LUP.html#a5772b3b974679b5de484493c370f9751">is_squared</a><a class="code" href="classhif_1_1LUP.html#a5772b3b974679b5de484493c370f9751">(</a><a class="code" href="classhif_1_1LUP.html#a5772b3b974679b5de484493c370f9751">)</a>, <span class="stringliteral">&quot;the matrix must be squared!&quot;</span>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__util.html#ga4250b44b37b1d4d98cd26322411ae4f5">hif_verbose</a>(INFO, opts)) <a class="code" href="group__util.html#gac5c7a3045b13d305bff54f831a959ccb">hif_info</a>(<span class="stringliteral">&quot;factorizing dense level by LU...&quot;</span>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classhif_1_1LUP.html#a0edda977bed9d85bc3d8224c99f535f9">_ipiv</a><a class="code" href="classhif_1_1Array.html#aaff95a415c82a718d3ff606bd843c24a">.</a><a class="code" href="classhif_1_1Array.html#aaff95a415c82a718d3ff606bd843c24a">resize</a><a class="code" href="classhif_1_1Array.html#aaff95a415c82a718d3ff606bd843c24a">(</a><a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.nrows()<a class="code" href="classhif_1_1Array.html#aaff95a415c82a718d3ff606bd843c24a">)</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> info = <a class="code" href="classhif_1_1LUP.html#abad2930b93568a959934c66f7ee46e6d">lapack_kernel</a>::getrf(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>, <a class="code" href="classhif_1_1LUP.html#a0edda977bed9d85bc3d8224c99f535f9">_ipiv</a>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (info &lt; 0)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="group__util.html#ga99b9778cc10f683d4a2d0b715b351fe1">hif_error</a><a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">(</a><span class="stringliteral">&quot;GETRF returned negative info!&quot;</span>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info &gt; 0) {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="group__util.html#gad660845fb8ce46f4f09885d327b12133">hif_warning</a>(</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <span class="stringliteral">&quot;GETRF returned positive info, U(%zd,%zd) is exactly zero! &quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <span class="stringliteral">&quot;Consider using QRCP for small scale solver!&quot;</span><a class="code" href="group__util.html#ga1d4c2000af1b3a9f14ece0c026d1c39a">,</a></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          (<a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a>)info<a class="code" href="group__util.html#ga1d4c2000af1b3a9f14ece0c026d1c39a">,</a> (<a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a>)info);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="classhif_1_1LUP.html#a9f4aee22640b511c62c6ada914a23cad">_rank</a> = info - 1;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="classhif_1_1LUP.html#a9f4aee22640b511c62c6ada914a23cad">_rank</a> = <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.ncols();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">/// \brief refactorize the dense block</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">/// \param[in] opts control parameters, see \ref Options</span></div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#ad0da1e4ba9448e3c979af601d6301d83">  123</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#ad0da1e4ba9448e3c979af601d6301d83">refactorize</a>(<span class="keyword">const</span> <a class="code" href="group__itr.html#ga8af676f52fa6072d6264436495d20772">Options</a> &amp;opts) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// copy backup</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.resize(<a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.nrows(), <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.ncols());</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    std::copy(<a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.array().cbegin(), <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.array().cend(),</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;              <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.array().begin());</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classhif_1_1LUP.html#a8c2bef9ad4a5bcef602fdcd682c66683">factorize</a><a class="code" href="classhif_1_1LUP.html#a8c2bef9ad4a5bcef602fdcd682c66683">(</a>opts<a class="code" href="classhif_1_1LUP.html#a8c2bef9ad4a5bcef602fdcd682c66683">)</a>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">/// \brief solve \f$\mathbf{LUx}=\mathbf{Px}\f$</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">/// \param[in,out] x input rhs, output solution</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">/// \param[in] tran (optional) tranpose flag</span></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a7a636579baa84f3b67ed6ba5e25e7ff7">  134</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#a7a636579baa84f3b67ed6ba5e25e7ff7">solve</a>(<a class="code" href="classhif_1_1Array.html">Array</a>&lt;<a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>&gt; &amp;x, <span class="keyword">const</span> <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> <span class="comment">/* rank */</span> = 0,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">bool</span>         tran = <span class="keyword">false</span>) <span class="keyword">const</span> {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.empty() || <a class="code" href="classhif_1_1LUP.html#a0edda977bed9d85bc3d8224c99f535f9">_ipiv</a><a class="code" href="classhif_1_1Array.html#ae6c556545187f3d09a81fd17a65f741b">.</a><a class="code" href="classhif_1_1Array.html#ae6c556545187f3d09a81fd17a65f741b">empty</a><a class="code" href="classhif_1_1Array.html#ae6c556545187f3d09a81fd17a65f741b">(</a><a class="code" href="classhif_1_1Array.html#ae6c556545187f3d09a81fd17a65f741b">)</a>,</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="stringliteral">&quot;either the matrix is not set or the factorization has not yet done!&quot;</span>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(x.size() != <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.nrows(),</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                 <span class="stringliteral">&quot;unmatched sizes between system and rhs&quot;</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classhif_1_1LUP.html#abad2930b93568a959934c66f7ee46e6d">lapack_kernel</a>::getrs(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>, <a class="code" href="classhif_1_1LUP.html#a0edda977bed9d85bc3d8224c99f535f9">_ipiv</a>, x, tran ? <span class="stringliteral">&#39;T&#39;</span> : <span class="stringliteral">&#39;N&#39;</span>) &lt; 0)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <a class="code" href="group__util.html#ga99b9778cc10f683d4a2d0b715b351fe1">hif_error</a><a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">(</a><span class="stringliteral">&quot;GETRS returned negative info!&quot;</span>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">/// \brief wrapper if \a value_type is different from input&#39;s</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> ArrayType&gt;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#ad16aa7ab7f631d3d64504d82c9684d34">  147</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#ad16aa7ab7f631d3d64504d82c9684d34">solve</a>(ArrayType &amp;x, <span class="keyword">const</span> <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> <span class="comment">/* rank */</span> = 0,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">bool</span> tran = <span class="keyword">false</span>) <span class="keyword">const</span> {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">_x</a>.resize(x.size());</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    std::copy(x.cbegin(), x.cend(), <a class="code" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">_x</a>.begin());</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    solve(<a class="code" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">_x</a>, <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a>(0), tran);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    std::copy(<a class="code" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">_x</a>.cbegin(), <a class="code" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">_x</a>.cend(), x.begin());</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">/// \brief solve with multiple RHS</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> Nrhs&gt;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a25d99a0179bbde3720577f41c1b43306">  157</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#a25d99a0179bbde3720577f41c1b43306">solve_mrhs</a>(<a class="code" href="classhif_1_1Array.html">Array</a>&lt;std::array&lt;T, Nrhs&gt;&gt; &amp;x, <span class="keyword">const</span> <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> = 0,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">bool</span>                  tran = <span class="keyword">false</span>) <span class="keyword">const</span> {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.empty() || <a class="code" href="classhif_1_1LUP.html#a0edda977bed9d85bc3d8224c99f535f9">_ipiv</a><a class="code" href="classhif_1_1Array.html#ae6c556545187f3d09a81fd17a65f741b">.</a><a class="code" href="classhif_1_1Array.html#ae6c556545187f3d09a81fd17a65f741b">empty</a><a class="code" href="classhif_1_1Array.html#ae6c556545187f3d09a81fd17a65f741b">(</a><a class="code" href="classhif_1_1Array.html#ae6c556545187f3d09a81fd17a65f741b">)</a>,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="stringliteral">&quot;either the matrix is not set or the factorization has not yet done!&quot;</span>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(x.size() != <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>.nrows(),</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                 <span class="stringliteral">&quot;unmatched sizes between system and rhs&quot;</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">_mrhs</a>.resize(x.size(), Nrhs);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> j = 0; j &lt; Nrhs; ++j)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> i(0); i &lt; x.size(); ++i) <a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">_mrhs</a><a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">(</a>i<a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">,</a> j<a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">)</a> = x[i][j];</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classhif_1_1LUP.html#abad2930b93568a959934c66f7ee46e6d">lapack_kernel</a>::getrs(<a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>, <a class="code" href="classhif_1_1LUP.html#a0edda977bed9d85bc3d8224c99f535f9">_ipiv</a>, <a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">_mrhs</a>, tran ? <span class="stringliteral">&#39;T&#39;</span> : <span class="stringliteral">&#39;N&#39;</span>) &lt; 0)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="group__util.html#ga99b9778cc10f683d4a2d0b715b351fe1">hif_error</a><a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">(</a><span class="stringliteral">&quot;GETRS returned negative info!&quot;</span>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> j = 0; j &lt; Nrhs; ++j)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> i(0); i &lt; x.size(); ++i) x[i][j] = <a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">_mrhs</a><a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">(</a>i<a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">,</a> j<a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">)</a>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">/// \brief compute \f$\mathbf{y}=\mathbf{P}^{T}\mathbf{LUx}\f$</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">/// \param[in] x input vector</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">/// \param[out] y output vector</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">/// \param[in] tran (optional) tranpose flag</span></div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a463b17897a6e1ca939140ffa66c121e6">  177</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#a463b17897a6e1ca939140ffa66c121e6">multiply</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1Array.html">Array</a>&lt;<a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>&gt; &amp;x, <a class="code" href="classhif_1_1Array.html">Array</a>&lt;<a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>&gt; &amp;y,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> <span class="comment">/* rank */</span> = 0,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">bool</span> tran            = <span class="keyword">false</span>) <span class="keyword">const</span> {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(x.size() != <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>.nrows(),</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                 <span class="stringliteral">&quot;unmatched sizes between system and x&quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(x.size() != y.size(), <span class="stringliteral">&quot;unmatched sizes x and y&quot;</span>);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="classhif_1_1LUP.html#abad2930b93568a959934c66f7ee46e6d">lapack_kernel</a>::gemv(tran ? <span class="stringliteral">&#39;C&#39;</span> : <span class="stringliteral">&#39;N&#39;</span>, <a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>(1), <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>, x,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                        <a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>(0), y);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">/// \brief wrapper if \a value_type is different from input&#39;s</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> ArrayIn, <span class="keyword">class</span> ArrayOut&gt;</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#ae7c07b614a8ab55ed6860a2a2d01fc32">  189</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1LUP.html#ae7c07b614a8ab55ed6860a2a2d01fc32">multiply</a>(<span class="keyword">const</span> ArrayIn &amp;x, ArrayOut &amp;y,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a> <span class="comment">/* rank */</span> = 0,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">bool</span> tran            = <span class="keyword">false</span>) <span class="keyword">const</span> {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">_x</a>.resize(x.size());</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="classhif_1_1LUP.html#aeb3e3f77738e486b1fd7ba167ef57a64">_y</a>.resize(y.size());</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    std::copy(x.cbegin(), x.cend(), <a class="code" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">_x</a>.begin());</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    multiply(<a class="code" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">_x</a>, <a class="code" href="classhif_1_1LUP.html#aeb3e3f77738e486b1fd7ba167ef57a64">_y</a>, <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a>(0), tran);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    std::copy(<a class="code" href="classhif_1_1LUP.html#aeb3e3f77738e486b1fd7ba167ef57a64">_y</a>.cbegin(), <a class="code" href="classhif_1_1LUP.html#aeb3e3f77738e486b1fd7ba167ef57a64">_y</a>.cend(), y.begin());</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">  200</a></span>&#160;  <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a>                <a class="code" href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">_mat</a>;         <span class="comment">///&lt; matrix</span></div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">  201</a></span>&#160;  <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a>                <a class="code" href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">_mat_backup</a>;  <span class="comment">///&lt; backup matrix</span></div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a9f4aee22640b511c62c6ada914a23cad">  202</a></span>&#160;  <a class="code" href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">size_type</a>                 <a class="code" href="classhif_1_1LUP.html#a9f4aee22640b511c62c6ada914a23cad">_rank</a>;        <span class="comment">///&lt; rank</span></div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">  203</a></span>&#160;  <span class="keyword">mutable</span> <a class="code" href="classhif_1_1Array.html">Array</a>&lt;<a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>&gt; <a class="code" href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">_x</a>;     <span class="comment">///&lt; buffer for handling solve in derived</span></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#aeb3e3f77738e486b1fd7ba167ef57a64">  204</a></span>&#160;  <span class="keyword">mutable</span> <a class="code" href="classhif_1_1Array.html">Array</a>&lt;<a class="code" href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">value_type</a>&gt; <a class="code" href="classhif_1_1LUP.html#aeb3e3f77738e486b1fd7ba167ef57a64">_y</a>;     <span class="comment">///&lt; buffer for handling mv in derived</span></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">  205</a></span>&#160;  <span class="keyword">mutable</span> <a class="code" href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">dense_type</a>        <a class="code" href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">_mrhs</a>;  <span class="comment">///&lt; multiple RHS buffer</span></div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="classhif_1_1LUP.html#a0edda977bed9d85bc3d8224c99f535f9">  206</a></span>&#160;  <a class="code" href="classhif_1_1Array.html">Array</a>&lt;<a class="code" href="group__sss.html#ga32cb79b3dc80154753e3e7fff6d7d4e1">hif_lapack_int</a>&gt;     <a class="code" href="classhif_1_1LUP.html#a0edda977bed9d85bc3d8224c99f535f9">_ipiv</a>;  <span class="comment">///&lt; row pivoting array</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;};</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}  <span class="comment">// namespace hif</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">endif</span>  <span class="comment">// _HIF_SMALLSCALE_LUP_HPP</span></div><div class="ttc" id="group__itr_html_ga8af676f52fa6072d6264436495d20772"><div class="ttname"><a href="group__itr.html#ga8af676f52fa6072d6264436495d20772">hif::Options</a></div><div class="ttdeci">hif_Options Options</div><div class="ttdoc">type wrapper </div><div class="ttdef"><b>Definition:</b> <a href="Options_8h_source.html#l00272">Options.h:272</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_aaa4e600c5b8cb4b4f324cfbf164d3d23"><div class="ttname"><a href="classhif_1_1LUP.html#aaa4e600c5b8cb4b4f324cfbf164d3d23">hif::LUP::mat_backup</a></div><div class="ttdeci">const dense_type &amp; mat_backup() const</div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00065">LUP.hpp:65</a></div></div>
<div class="ttc" id="group__util_html_gad660845fb8ce46f4f09885d327b12133"><div class="ttname"><a href="group__util.html#gad660845fb8ce46f4f09885d327b12133">hif_warning</a></div><div class="ttdeci">#define hif_warning(__msgs...)</div><div class="ttdoc">print warning message </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00172">log.hpp:172</a></div></div>
<div class="ttc" id="classhif_1_1Lapack_html"><div class="ttname"><a href="classhif_1_1Lapack.html">hif::Lapack</a></div><div class="ttdef"><b>Definition:</b> <a href="lapack_8hpp_source.html#l00051">lapack.hpp:51</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a8c2bef9ad4a5bcef602fdcd682c66683"><div class="ttname"><a href="classhif_1_1LUP.html#a8c2bef9ad4a5bcef602fdcd682c66683">hif::LUP::factorize</a></div><div class="ttdeci">void factorize(const Options &amp;opts)</div><div class="ttdoc">perform LU with partial pivoting </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00102">LUP.hpp:102</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a6509a2d56b2855847939527905555ff2"><div class="ttname"><a href="classhif_1_1LUP.html#a6509a2d56b2855847939527905555ff2">hif::LUP::LUP</a></div><div class="ttdeci">LUP()</div><div class="ttdoc">default constructor </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00058">LUP.hpp:58</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_aeb3e3f77738e486b1fd7ba167ef57a64"><div class="ttname"><a href="classhif_1_1LUP.html#aeb3e3f77738e486b1fd7ba167ef57a64">hif::LUP::_y</a></div><div class="ttdeci">Array&lt; value_type &gt; _y</div><div class="ttdoc">buffer for handling mv in derived </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00204">LUP.hpp:204</a></div></div>
<div class="ttc" id="group__sss_html_ga32cb79b3dc80154753e3e7fff6d7d4e1"><div class="ttname"><a href="group__sss.html#ga32cb79b3dc80154753e3e7fff6d7d4e1">hif_lapack_int</a></div><div class="ttdeci">HIF_LAPACK_INT hif_lapack_int</div><div class="ttdoc">lapack integer type </div><div class="ttdef"><b>Definition:</b> <a href="config_8hpp_source.html#l00057">config.hpp:57</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_ae7c07b614a8ab55ed6860a2a2d01fc32"><div class="ttname"><a href="classhif_1_1LUP.html#ae7c07b614a8ab55ed6860a2a2d01fc32">hif::LUP::multiply</a></div><div class="ttdeci">void multiply(const ArrayIn &amp;x, ArrayOut &amp;y, const size_type=0, const bool tran=false) const</div><div class="ttdoc">wrapper if value_type is different from input&amp;#39;s </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00189">LUP.hpp:189</a></div></div>
<div class="ttc" id="classhif_1_1Array_html_aaff95a415c82a718d3ff606bd843c24a"><div class="ttname"><a href="classhif_1_1Array.html#aaff95a415c82a718d3ff606bd843c24a">hif::Array::resize</a></div><div class="ttdeci">void resize(const size_type n, bool presv=true)</div><div class="ttdoc">resize an Array with new size </div><div class="ttdef"><b>Definition:</b> <a href="Array_8hpp_source.html#l00351">Array.hpp:351</a></div></div>
<div class="ttc" id="group__util_html_ga9d3c0fc68115b1a021d3f3ce48d02c67"><div class="ttname"><a href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a></div><div class="ttdeci">#define hif_error_if(__cond, __msgs...)</div><div class="ttdoc">conditionally print warning message and abort </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00200">log.hpp:200</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a0935f9ac7ef9a137dfa4cde55c7dd6d3"><div class="ttname"><a href="classhif_1_1LUP.html#a0935f9ac7ef9a137dfa4cde55c7dd6d3">hif::LUP::_mrhs</a></div><div class="ttdeci">dense_type _mrhs</div><div class="ttdoc">multiple RHS buffer </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00205">LUP.hpp:205</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_af44510a45247d140daf7ff454d0b90f5"><div class="ttname"><a href="classhif_1_1LUP.html#af44510a45247d140daf7ff454d0b90f5">hif::LUP::size_type</a></div><div class="ttdeci">dense_type::size_type size_type</div><div class="ttdoc">size type </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00052">LUP.hpp:52</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a7a636579baa84f3b67ed6ba5e25e7ff7"><div class="ttname"><a href="classhif_1_1LUP.html#a7a636579baa84f3b67ed6ba5e25e7ff7">hif::LUP::solve</a></div><div class="ttdeci">void solve(Array&lt; value_type &gt; &amp;x, const size_type=0, const bool tran=false) const</div><div class="ttdoc">solve  </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00134">LUP.hpp:134</a></div></div>
<div class="ttc" id="group__util_html_ga4250b44b37b1d4d98cd26322411ae4f5"><div class="ttname"><a href="group__util.html#ga4250b44b37b1d4d98cd26322411ae4f5">hif_verbose</a></div><div class="ttdeci">#define hif_verbose(__LVL, __opt)</div><div class="ttdoc">return true if certain verbose level is defined </div><div class="ttdef"><b>Definition:</b> <a href="Options_8h_source.html#l00594">Options.h:594</a></div></div>
<div class="ttc" id="classhif_1_1DenseMatrix_html"><div class="ttname"><a href="classhif_1_1DenseMatrix.html">hif::DenseMatrix</a></div><div class="ttdoc">Dense storage. </div><div class="ttdef"><b>Definition:</b> <a href="DenseMatrix_8hpp_source.html#l00169">DenseMatrix.hpp:169</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a9f4aee22640b511c62c6ada914a23cad"><div class="ttname"><a href="classhif_1_1LUP.html#a9f4aee22640b511c62c6ada914a23cad">hif::LUP::_rank</a></div><div class="ttdeci">size_type _rank</div><div class="ttdoc">rank </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00202">LUP.hpp:202</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a463b17897a6e1ca939140ffa66c121e6"><div class="ttname"><a href="classhif_1_1LUP.html#a463b17897a6e1ca939140ffa66c121e6">hif::LUP::multiply</a></div><div class="ttdeci">void multiply(const Array&lt; value_type &gt; &amp;x, Array&lt; value_type &gt; &amp;y, const size_type=0, const bool tran=false) const</div><div class="ttdoc">compute  </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00177">LUP.hpp:177</a></div></div>
<div class="ttc" id="classhif_1_1Array_html_ae6c556545187f3d09a81fd17a65f741b"><div class="ttname"><a href="classhif_1_1Array.html#ae6c556545187f3d09a81fd17a65f741b">hif::Array::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="Array_8hpp_source.html#l00322">Array.hpp:322</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_ad16aa7ab7f631d3d64504d82c9684d34"><div class="ttname"><a href="classhif_1_1LUP.html#ad16aa7ab7f631d3d64504d82c9684d34">hif::LUP::solve</a></div><div class="ttdeci">void solve(ArrayType &amp;x, const size_type=0, const bool tran=false) const</div><div class="ttdoc">wrapper if value_type is different from input&amp;#39;s </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00147">LUP.hpp:147</a></div></div>
<div class="ttc" id="group__util_html_gac5c7a3045b13d305bff54f831a959ccb"><div class="ttname"><a href="group__util.html#gac5c7a3045b13d305bff54f831a959ccb">hif_info</a></div><div class="ttdeci">#define hif_info(__msgs...)</div><div class="ttdoc">general message streaming macro wrapper </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00152">log.hpp:152</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_ad0da1e4ba9448e3c979af601d6301d83"><div class="ttname"><a href="classhif_1_1LUP.html#ad0da1e4ba9448e3c979af601d6301d83">hif::LUP::refactorize</a></div><div class="ttdeci">void refactorize(const Options &amp;opts)</div><div class="ttdoc">refactorize the dense block </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00123">LUP.hpp:123</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a4baba2759b4c27486e91c2cf16514f99"><div class="ttname"><a href="classhif_1_1LUP.html#a4baba2759b4c27486e91c2cf16514f99">hif::LUP::value_type</a></div><div class="ttdeci">ValueType value_type</div><div class="ttdoc">value type </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00049">LUP.hpp:49</a></div></div>
<div class="ttc" id="namespacehif_html"><div class="ttname"><a href="namespacehif.html">hif</a></div><div class="ttdef"><b>Definition:</b> <a href="Crout_8hpp_source.html#l00040">Crout.hpp:40</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_aeafbb1731e87bfb259c47dcb54c2b55d"><div class="ttname"><a href="classhif_1_1LUP.html#aeafbb1731e87bfb259c47dcb54c2b55d">hif::LUP::_mat</a></div><div class="ttdeci">dense_type _mat</div><div class="ttdoc">matrix </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00200">LUP.hpp:200</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a523807c09323aeb2667ab13e10967f2d"><div class="ttname"><a href="classhif_1_1LUP.html#a523807c09323aeb2667ab13e10967f2d">hif::LUP::set_matrix</a></div><div class="ttdeci">void set_matrix(dense_type &amp;&amp;mat)</div><div class="ttdoc">set a dense operator, this is needed for H version </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00083">LUP.hpp:83</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a0a74efd2ca428b022aa5fb6b376d01c2"><div class="ttname"><a href="classhif_1_1LUP.html#a0a74efd2ca428b022aa5fb6b376d01c2">hif::LUP::_mat_backup</a></div><div class="ttdeci">dense_type _mat_backup</div><div class="ttdoc">backup matrix </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00201">LUP.hpp:201</a></div></div>
<div class="ttc" id="group__util_html_ga1d4c2000af1b3a9f14ece0c026d1c39a"><div class="ttname"><a href="group__util.html#ga1d4c2000af1b3a9f14ece0c026d1c39a">hif::warning</a></div><div class="ttdeci">void warning(const char *prefix, const char *file, const char *func, const unsigned line, std::string msg,...)</div><div class="ttdoc">warning information streaming, dump to HIF_STDERR </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00092">log.hpp:92</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a25d99a0179bbde3720577f41c1b43306"><div class="ttname"><a href="classhif_1_1LUP.html#a25d99a0179bbde3720577f41c1b43306">hif::LUP::solve_mrhs</a></div><div class="ttdeci">void solve_mrhs(Array&lt; std::array&lt; T, Nrhs &gt;&gt; &amp;x, const size_type=0, const bool tran=false) const</div><div class="ttdoc">solve with multiple RHS </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00157">LUP.hpp:157</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a0b004683a143aab89fdf4dd9c759a51b"><div class="ttname"><a href="classhif_1_1LUP.html#a0b004683a143aab89fdf4dd9c759a51b">hif::LUP::mat_backup</a></div><div class="ttdeci">dense_type &amp; mat_backup()</div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00066">LUP.hpp:66</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a7bc0893bd49694d691276d721e3e6bfa"><div class="ttname"><a href="classhif_1_1LUP.html#a7bc0893bd49694d691276d721e3e6bfa">hif::LUP::dense_type</a></div><div class="ttdeci">DenseMatrix&lt; value_type &gt; dense_type</div><div class="ttdoc">dense matrix </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00050">LUP.hpp:50</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_aaa1fc034e4b243f909aaeb07717642f5"><div class="ttname"><a href="classhif_1_1LUP.html#aaa1fc034e4b243f909aaeb07717642f5">hif::LUP::full_rank</a></div><div class="ttdeci">bool full_rank() const</div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00068">LUP.hpp:68</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a6adb5b3a405792d4ada25a6250debe04"><div class="ttname"><a href="classhif_1_1LUP.html#a6adb5b3a405792d4ada25a6250debe04">hif::LUP::mat</a></div><div class="ttdeci">const dense_type &amp; mat() const</div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00063">LUP.hpp:63</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html"><div class="ttname"><a href="classhif_1_1LUP.html">hif::LUP</a></div><div class="ttdoc">LU with partial pivoting for small scale solver. </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00047">LUP.hpp:47</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a0edda977bed9d85bc3d8224c99f535f9"><div class="ttname"><a href="classhif_1_1LUP.html#a0edda977bed9d85bc3d8224c99f535f9">hif::LUP::_ipiv</a></div><div class="ttdeci">Array&lt; hif_lapack_int &gt; _ipiv</div><div class="ttdoc">row pivoting array </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00206">LUP.hpp:206</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_abad2930b93568a959934c66f7ee46e6d"><div class="ttname"><a href="classhif_1_1LUP.html#abad2930b93568a959934c66f7ee46e6d">hif::LUP::lapack_kernel</a></div><div class="ttdeci">Lapack&lt; value_type &gt; lapack_kernel</div><div class="ttdoc">lapack backend </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00051">LUP.hpp:51</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_add6e2ce31ee34826ec61d20a56446e30"><div class="ttname"><a href="classhif_1_1LUP.html#add6e2ce31ee34826ec61d20a56446e30">hif::LUP::rank</a></div><div class="ttdeci">size_type rank() const</div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00062">LUP.hpp:62</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a1d7efdb95eb4ad679ff1f6dbad02a5cd"><div class="ttname"><a href="classhif_1_1LUP.html#a1d7efdb95eb4ad679ff1f6dbad02a5cd">hif::LUP::_x</a></div><div class="ttdeci">Array&lt; value_type &gt; _x</div><div class="ttdoc">buffer for handling solve in derived </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00203">LUP.hpp:203</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a54366070daa0e6d7714a270e1fa99d8f"><div class="ttname"><a href="classhif_1_1LUP.html#a54366070daa0e6d7714a270e1fa99d8f">hif::LUP::method</a></div><div class="ttdeci">static const char * method()</div><div class="ttdoc">get the solver type </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00055">LUP.hpp:55</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a678c46c53224f0d8579a8766859d04b9"><div class="ttname"><a href="classhif_1_1LUP.html#a678c46c53224f0d8579a8766859d04b9">hif::LUP::set_matrix</a></div><div class="ttdeci">void set_matrix(const CsType &amp;cs)</div><div class="ttdoc">set operator </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00074">LUP.hpp:74</a></div></div>
<div class="ttc" id="group__util_html_ga0a3c88ad06db9caf44d1a64d51ebb7b2"><div class="ttname"><a href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">hif::error</a></div><div class="ttdeci">void error(const char *prefix, const char *file, const char *func, const unsigned line, std::string msg,...)</div><div class="ttdoc">error information streaming, dump to HIF_STDERR </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00125">log.hpp:125</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a5772b3b974679b5de484493c370f9751"><div class="ttname"><a href="classhif_1_1LUP.html#a5772b3b974679b5de484493c370f9751">hif::LUP::is_squared</a></div><div class="ttdeci">bool is_squared() const</div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00067">LUP.hpp:67</a></div></div>
<div class="ttc" id="classhif_1_1Array_html"><div class="ttname"><a href="classhif_1_1Array.html">hif::Array</a></div><div class="ttdoc">Core data structure used in compressed storage. </div><div class="ttdef"><b>Definition:</b> <a href="Array_8hpp_source.html#l00073">Array.hpp:73</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a25383158334abea9d726f316c4bc4edc"><div class="ttname"><a href="classhif_1_1LUP.html#a25383158334abea9d726f316c4bc4edc">hif::LUP::set_matrix</a></div><div class="ttdeci">void set_matrix(const DenseMatrix&lt; T &gt; &amp;mat)</div><div class="ttdoc">set a dense operator from other data type </div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00093">LUP.hpp:93</a></div></div>
<div class="ttc" id="group__util_html_ga99b9778cc10f683d4a2d0b715b351fe1"><div class="ttname"><a href="group__util.html#ga99b9778cc10f683d4a2d0b715b351fe1">hif_error</a></div><div class="ttdeci">#define hif_error(__msgs...)</div><div class="ttdoc">print warning message and abort </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00193">log.hpp:193</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_ac0d4a8db299fe2e8ecf322533cbea470"><div class="ttname"><a href="classhif_1_1LUP.html#ac0d4a8db299fe2e8ecf322533cbea470">hif::LUP::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00061">LUP.hpp:61</a></div></div>
<div class="ttc" id="classhif_1_1LUP_html_a716caf44704926e00cb0dfb8c48f0a3e"><div class="ttname"><a href="classhif_1_1LUP.html#a716caf44704926e00cb0dfb8c48f0a3e">hif::LUP::mat</a></div><div class="ttdeci">dense_type &amp; mat()</div><div class="ttdef"><b>Definition:</b> <a href="LUP_8hpp_source.html#l00064">LUP.hpp:64</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b71a56306648c2ebe777f648dc45e4a5.html">hif</a></li><li class="navelem"><a class="el" href="dir_fd2f6341f95d3c6560f44cec72c65ef1.html">small_scale</a></li><li class="navelem"><a class="el" href="LUP_8hpp.html">LUP.hpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
