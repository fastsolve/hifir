<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HIFIR: AugmentedStorage.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HIFIR
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('AugmentedStorage_8hpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AugmentedStorage.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AugmentedStorage_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//                  This file is part of the HIFIR library                   //</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * \file hif/ds/AugmentedStorage.hpp</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * \brief Core about augmented CRS and CCS storage formats</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * \author Qiao Chen</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">\verbatim</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">Copyright (C) 2020 NumGeom Group at Stony Brook University</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">it under the terms of the GNU Affero General Public License as published</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">by the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">(at your option) any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">GNU Affero General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">You should have received a copy of the GNU Affero General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">\endverbatim</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">ifndef</span> <span class="preprocessor">_HIF_DS_AUGMENTEDSTORAGE_HPP</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">_HIF_DS_AUGMENTEDSTORAGE_HPP</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">algorithm</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">numeric</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;hif/ds/Array.hpp&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;hif/utils/common.hpp&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">namespace</span> <a class="code" href="namespacehif.html">hif</a> {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace</span> <a class="code" href="namespacehif_1_1internal.html">internal</a> {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/// \class AugmentedCore</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/// \brief A group of forward link lists for CompressedStorage</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/// \tparam IndexType index type</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// \sa CompressedStorage</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">/// \ingroup ds</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/// This is the version of explicitly maintaining the value positions, i.e.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">/// the mapping from linked lists to the compressed storage, and corresponding</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/// inverse mapping, i.e. the reversed mapping from compressed storage to the</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">/// linked lists. Notice that this is a flexible approach, meaning that one</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/// can use this data structure to interchange rows/columns in arbitrary orders.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/// However, the drawback is also obvious, we need to mainly two nnz-sized</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/// arrays, which are memory inefficient.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/// An alternative idea is to take into account of Crout updating, by using</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">/// the leading positions. This approach is relatively counterintuitive, but</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/// can be efficient in memory usage. The drawback is that this will make the</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/// augmented data structure only suitable for Crout update, which is less a</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">/// concern for this project.</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> IndexType&gt;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html">   61</a></span>&#160;<span class="keyword">class</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html">AugmentedCore</a> {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">   63</a></span>&#160;  <span class="keyword">typedef</span> IndexType                       <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a>;   <span class="comment">///&lt; index</span></div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">   64</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classhif_1_1Array.html">Array</a>&lt;<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a>&gt;               <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a>;  <span class="comment">///&lt; container</span></div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">   65</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a>::<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a>;    <span class="comment">///&lt; size</span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a9f05457feb06f3ba4c5935ddf1b8c7b8">   66</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html">AugmentedCore</a>                   <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a9f05457feb06f3ba4c5935ddf1b8c7b8">this_type</a>;    <span class="comment">///&lt; this</span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a1a66f5f9e0e663f3df65ae6bdd7b34ee">   67</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a>::<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1a66f5f9e0e663f3df65ae6bdd7b34ee">iterator</a>  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1a66f5f9e0e663f3df65ae6bdd7b34ee">iterator</a>;     <span class="comment">///&lt; iterator type</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#ade25a45dd096ce1ffc0fa6c14e101dc0">   70</a></span>&#160;  <span class="keyword">constexpr</span> <span class="keyword">static</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ade25a45dd096ce1ffc0fa6c14e101dc0">_NIL</a> = std::numeric_limits&lt;<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a>&gt;::max();</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">/// \brief default constructor</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ace8af777b929a2316e265adfe19b6e94">AugmentedCore</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">/// \brief constructor with number of lists</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">/// \param[in] nlist number of linked lists</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">/// \param[in] nnz total number of nonzeros</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">/// \param[in] reserve if \a true (default), then reserve spaces</span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a0620e3e050522475412ea37c8da10c0f">   80</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a0620e3e050522475412ea37c8da10c0f">AugmentedCore</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> nlist, <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> nnz = 0,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                         <span class="keywordtype">bool</span> reserve = <span class="keyword">true</span>)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      : <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>(),</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>(nlist, <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ade25a45dd096ce1ffc0fa6c14e101dc0">_NIL</a>),</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>(),</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>(nlist, <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ade25a45dd096ce1ffc0fa6c14e101dc0">_NIL</a>),</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>(),</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>(nlist, <span class="keyword">static_cast</span>&lt;<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a>&gt;(0)) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (nnz) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">if</span> (reserve) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>.reserve(nnz);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>.reserve(nnz);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>.reserve(nnz);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>.reserve(nnz);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>.resize(nnz);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>.resize(nnz);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>.resize(nnz);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>.reserve(nnz);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">/// \brief shallow copy of clone</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">/// \param[in] other another augmented data structure</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">/// \param[in] clone if \a false (default), do shallow copy</span></div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a1b897647f88793ea895886e8610776b8">  106</a></span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1b897647f88793ea895886e8610776b8">AugmentedCore</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a9f05457feb06f3ba4c5935ddf1b8c7b8">this_type</a> &amp;other, <span class="keywordtype">bool</span> clone = <span class="keyword">false</span>)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      : <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>(other._node_inds, clone),</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>(other._node_start, clone),</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>(other._node_next, clone),</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>(other._node_end, clone),</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>(other._val_pos, clone),</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>(other._val_pos_inv, clone),</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>(other._node_counts, clone) {}</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// default stuffs</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a54cb7b45c2044f57ded2ec747101423b">AugmentedCore</a>(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a9f05457feb06f3ba4c5935ddf1b8c7b8">this_type</a> &amp;&amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a9f05457feb06f3ba4c5935ddf1b8c7b8">this_type</a> &amp;<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1297f198aef5008a62ff08721b5827c5">operator</a>=(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a9f05457feb06f3ba4c5935ddf1b8c7b8">this_type</a> &amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a9f05457feb06f3ba4c5935ddf1b8c7b8">this_type</a> &amp;<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a6907e0a5d9199977180b766f021d0bcf">operator</a>=(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a9f05457feb06f3ba4c5935ddf1b8c7b8">this_type</a> &amp;&amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">/// \brief check if a given node handle is NIL or not</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">/// \return if \a true, then the node is nil</span></div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a1d804c7d16688d89b8fbd6f4d4d3ddec">  122</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">constexpr</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1d804c7d16688d89b8fbd6f4d4d3ddec">is_nil</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a> i) { <span class="keywordflow">return</span> i == <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ade25a45dd096ce1ffc0fa6c14e101dc0">_NIL</a>; }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">/// \brief given a node handle, query its value position (index)</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">/// \note The index is in C-based system</span></div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#aafdb24aeb9ad87bc38c34c16c6018ab0">  126</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aafdb24aeb9ad87bc38c34c16c6018ab0">val_pos_idx</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> nid) <span class="keyword">const</span> {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(!is_nil((index_type)nid), <span class="stringliteral">&quot;NIL node detected&quot;</span>);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(nid &lt; _val_pos.size(), <span class="stringliteral">&quot;invalid nid %zd&quot;</span>, nid);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>[nid];</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc42aa3cc57e17515356f8d0b5b3340">  132</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc42aa3cc57e17515356f8d0b5b3340">val_pos</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>; }</div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a1027719cc0533e29c494fb340bc664cc">  133</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1027719cc0533e29c494fb340bc664cc">val_pos</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>; }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">/// \brief reserve spaces for nnz arrays</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">/// \param[in] nnz total number of nonzeros</span></div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a880653395442fe93cd78bd5f9355a421">  137</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a880653395442fe93cd78bd5f9355a421">reserve</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> nnz) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>.reserve(nnz);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>.reserve(nnz);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>.reserve(nnz);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>.reserve(nnz);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>.reserve(nnz);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#ac1216ed2b45caa57f69702738f43110f">  145</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ac1216ed2b45caa57f69702738f43110f">secondary_start</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>; }</div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a0e0f1ae065008c4b3740499e0e930fb7">  146</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a0e0f1ae065008c4b3740499e0e930fb7">secondary_start</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>; }</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#ab74bc294e80634cc9bdb1c9f358448b8">  147</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ab74bc294e80634cc9bdb1c9f358448b8">secondary_end</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>; }</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a5814caa9cf205fa07b26510d40719c8d">  148</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5814caa9cf205fa07b26510d40719c8d">secondary_end</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>; }</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a1241b26612f5086b4dcf6ba0aba8f2a9">  149</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1241b26612f5086b4dcf6ba0aba8f2a9">secondary_counts</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>; }</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#aa6a7519f1cb49dc63fe2814851c936db">  150</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa6a7519f1cb49dc63fe2814851c936db">secondary_counts</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>; }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">/// \brief begin assemble nodes</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">/// \param[in] nlist number of lists</span></div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a90a820138b5596fbfbda67c5db3a9706">  155</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a90a820138b5596fbfbda67c5db3a9706">_begin_assemble_nodes</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> nlist) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a> nil = <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ade25a45dd096ce1ffc0fa6c14e101dc0">_NIL</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>.resize(nlist);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>.resize(nlist);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>.resize(nlist);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// resize all nnz arrays to zero, thus reserve them b4hand is the way to go</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>.resize(0u);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>.resize(0u);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>.resize(0u);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>.resize(0u);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// also for n-sized arrays, set them to nil</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    std::fill_n(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>.begin(), nlist, nil);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    std::fill_n(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>.begin(), nlist, nil);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    std::fill_n(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>.begin(), nlist, <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a>(0));</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">/// \brief update linked lists given new nodes from back</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">/// \tparam Iter iterator type</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">/// \param[in] entry row or column index, in C-based system</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">/// \param[in] first starting iterator position of index range</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">/// \param[in] last pass-of-end iterator position of index range</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">/// \note Complexity: \f$\mathcal{O}(n)\f$, where n is size from first to last</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Iter&gt;</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a19b98bd8b49a88052d90d92e12c4c63f">  178</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a19b98bd8b49a88052d90d92e12c4c63f">_push_back_nodes</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> entry, Iter first, Iter last) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>      nnz   = std::distance(first, last);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> start = <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>.size();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>.resize(start + nnz);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// fill in node ids</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    std::fill_n(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>.begin() + start, nnz, entry);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// resize value positions</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>.resize(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>.size());</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>.resize(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>.size());</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>.resize(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>.size());</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// NOTE that first:last store the indices in compressed storage</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    Iter            itr = first;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> n   = <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>.size();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> i = start; i &lt; n; ++i, ++itr) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">// for newly added nodes, their next/val-pos/val-pos-inv are same</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>[i]       = i;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>[i]   = i;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>[i]     = <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ade25a45dd096ce1ffc0fa6c14e101dc0">_NIL</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> j = *itr;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(j &lt; _node_start.size(), <span class="stringliteral">&quot;%zd exceeds the bound in node_start&quot;</span>,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                 j);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="comment">// if we have _node_end[j] (_node_end is not ready when entry==0)</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1d804c7d16688d89b8fbd6f4d4d3ddec">is_nil</a><a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1d804c7d16688d89b8fbd6f4d4d3ddec">(</a><a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>[j]<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1d804c7d16688d89b8fbd6f4d4d3ddec">)</a>) <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>[<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>[j]] = i;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">// finally update _node_end</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>[j] = i;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">// need to check start index as well</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1d804c7d16688d89b8fbd6f4d4d3ddec">is_nil</a><a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1d804c7d16688d89b8fbd6f4d4d3ddec">(</a><a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>[j]<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1d804c7d16688d89b8fbd6f4d4d3ddec">)</a>) <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>[j] = i;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="comment">// increment the counter</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      ++<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>[j];</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">/// \brief get starting node ID</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">/// \param[in] lid linked list ID (C-based)</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a4e4ffb274c40098a63d5cb5d8cd49925">  212</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a4e4ffb274c40098a63d5cb5d8cd49925">_start_node</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> lid) <span class="keyword">const</span> {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(lid &lt; _node_start.size(), <span class="stringliteral">&quot;%zd exceeds the node start array&quot;</span>,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;               lid);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>[lid];</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">/// \brief get the next node ID</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">/// \param[in] nid node ID</span></div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a147b276bda7bf1f4ffce2efa5b0ad680">  220</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a147b276bda7bf1f4ffce2efa5b0ad680">_next_node</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> nid) <span class="keyword">const</span> {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(!is_nil((index_type)nid), <span class="stringliteral">&quot;NIL node detected&quot;</span>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(nid &lt; _node_inds.size(), <span class="stringliteral">&quot;invalid nid %zd&quot;</span>, nid);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>[nid];</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">/// \brief get node item ({col-,row-}index in aug-{ccx,crs}, correspondingly)</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">/// \param[in] nid node ID</span></div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a06d4f149c9cd53b8ee51f1651e9e161a">  228</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">index_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a06d4f149c9cd53b8ee51f1651e9e161a">_node_ind</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> nid) <span class="keyword">const</span> {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(!is_nil((index_type)nid), <span class="stringliteral">&quot;NIL node detected&quot;</span>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(nid &lt; _node_inds.size(), <span class="stringliteral">&quot;invalid nid %zd&quot;</span>, nid);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>[nid];</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">/// \brief given two existing indices, swap them explicitly</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">/// \param[in] p1 position 1</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">/// \param[in] p2 position 2</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">/// \note Complexity: \f$\mathcal{O}(1)\f$</span></div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a33e969242acdadf8fd2545fb7b61e203">  238</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a33e969242acdadf8fd2545fb7b61e203">_swap_val_pos_exp</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> p1, <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> p2) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(p1 &lt; _val_pos.size(), <span class="stringliteral">&quot;%zd exceeds val_pos size %zd&quot;</span>, p1,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;               _val_pos.size());</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(p2 &lt; _val_pos.size(), <span class="stringliteral">&quot;%zd exceeds val_pos size %zd&quot;</span>, p2,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;               _val_pos.size());</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// swap value positions</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    std::swap(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>[<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>[p1]], <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>[<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>[p2]]);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// swap the inverse mapping</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    std::swap(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>[p1], <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>[p2]);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">/// \brief rotate value positions toward left</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">/// \param[in] n **local** size, i.e. how many elements to shift</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">/// \param[in] src original position in **global** index</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">/// \note Complexity: \f$\mathcal{O}(n)\f$</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">/// \sa _rotate_val_pos_right</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">///</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">/// Firstly, rotate the inverse mapping, then assign the value positions</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">/// accordingly.</span></div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#acbf0b6153d6ed1ef17cd56e2c8e6007a">  257</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#acbf0b6153d6ed1ef17cd56e2c8e6007a">_rotate_val_pos_left</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> n, <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> src) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(src &lt; _val_pos_inv.size(), <span class="stringliteral">&quot;%zd exceeds val_pos_inv size %zd&quot;</span>,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;               src, _val_pos_inv.size());</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(src + n &lt;= _val_pos_inv.size(), <span class="stringliteral">&quot;%zd exceeds the length&quot;</span>,</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;               src + n);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    rotate_left(n, src, <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// then assign new positions</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">auto</span> itr = <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>.cbegin() + src;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// this is how to build inverse mapping</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> i = 0u; i &lt; n; ++i, ++itr) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>((size_type)*itr &lt; _val_pos.size(),</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                 <span class="stringliteral">&quot;inv-val-pos index %zd exceeds value position length&quot;</span>,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                 (size_type)*itr);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>[*itr] = i + src;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">/// \brief rotate value positions toward right</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">/// \param[in] n **local** size, i.e. how many elements to shift</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">/// \param[in] src original position in **global** index</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">/// \note Complexity: \f$\mathcal{O}(n)\f$</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">/// \sa _rotate_val_pos_left</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">///</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">/// Firstly, rotate the inverse mapping, then assign the value positions</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">/// accordingly.</span></div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a20b60fceffbc712e547e8c6002819230">  282</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a20b60fceffbc712e547e8c6002819230">_rotate_val_pos_right</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> n, <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> src) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(src &lt; _val_pos_inv.size(), <span class="stringliteral">&quot;%zd exceeds val_pos_inv size %zd&quot;</span>,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;               src, _val_pos_inv.size());</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// NOTE for clean implementation, we plus 1 before subtract n to avoid</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// ugly integer &quot;overflow&quot; (there is not overflow in unsigned anyway).</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// explian: src-n may become max(size_t), which, to me, seems ugly, even</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// though +1 will make it back to 0...</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> start = src + 1u - n;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    rotate_right(n, src, <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// then assign new positions</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">auto</span> itr = <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>.cbegin() + start;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// this is how to build inverse mapping</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> i = 0u; i &lt; n; ++i, ++itr) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>((size_type)*itr &lt; _val_pos.size(),</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                 <span class="stringliteral">&quot;inv-val-pos index %zd exceeds value position length&quot;</span>,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                 (size_type)*itr);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>[*itr] = i + start;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">/// \brief interchange the head and tail nodes given list i and k</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">/// \param[in] i i-th linked list</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">/// \param[in] k k-th linked list</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">/// \note Complexity: \f$\mathcal{O}(1)\f$</span></div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#adedceadba809a52bfd4a959084be3bb2">  306</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#adedceadba809a52bfd4a959084be3bb2">_interchange_ik_head_tail</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> i, <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> k) {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(i &lt; _node_start.size(), <span class="stringliteral">&quot;%zd exceeds node_start size %zd&quot;</span>, i,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;               _node_start.size());</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(k &lt; _node_start.size(), <span class="stringliteral">&quot;%zd exceeds node_start_ size %zd&quot;</span>, k,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;               _node_start.size());</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    std::swap(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>[i], <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>[k]);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    std::swap(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>[i], <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>[k]);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    std::swap(<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>[i], <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>[k]);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">/// \brief build augmented cores based on compressed storages</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">/// \param[in] nlist number of linked lists</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">/// \param[in] ind_start starting indices</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">/// \param[in] indices array storing the indices</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">/// \warning Advanced usaged</span></div><div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#ad711a5f12855b538ee7222d39300dc77">  321</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ad711a5f12855b538ee7222d39300dc77">_build_aug</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> nlist, <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;ind_start,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> &amp;indices) {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a>::const_iterator const_iterator;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        size_type(ind_start.back() - ind_start.front()) == indices.size(),</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="stringliteral">&quot;nnz size issue&quot;</span>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// reserve spaces</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> nnz = indices.size();</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a880653395442fe93cd78bd5f9355a421">reserve</a><a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a880653395442fe93cd78bd5f9355a421">(</a>nnz<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a880653395442fe93cd78bd5f9355a421">)</a>;                  <span class="comment">// reserve space</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a90a820138b5596fbfbda67c5db3a9706">_begin_assemble_nodes</a><a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a90a820138b5596fbfbda67c5db3a9706">(</a>nlist<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a90a820138b5596fbfbda67c5db3a9706">)</a>;  <span class="comment">// resize start/end to nlist</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> n = ind_start.size() - 1u;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> i = 0u; i &lt; n; ++i) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="comment">// hif_assert(j &lt; indices.size(), &quot;%zd exceeds indices size&quot;, j);</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> lnnz = ind_start[i + 1] - ind_start[i];</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keyword">auto</span> first = indices.cbegin() + ind_start[i], last = first + lnnz;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="comment">// push back nodes</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      _push_back_nodes&lt;const_iterator&gt;(i, first, last);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">/// \brief query total number of in a certain list</span></div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#afa3f2cae684947486386ee774c710782">  342</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#afa3f2cae684947486386ee774c710782">_nodes_in_list</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">size_type</a> i) <span class="keyword">const</span> {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(i &lt; _node_counts.size(), <span class="stringliteral">&quot;%zd exceeds total number of lists %zd&quot;</span>,</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;               i, _node_counts.size());</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>[i];</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">  349</a></span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">_node_inds</a>;    <span class="comment">///&lt; indices (values) of each node</span></div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">  350</a></span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">_node_start</a>;   <span class="comment">///&lt; head nodes</span></div><div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">  351</a></span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">_node_next</a>;    <span class="comment">///&lt; next nodes</span></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">  352</a></span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">_node_end</a>;     <span class="comment">///&lt; ending positions</span></div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">  353</a></span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">_val_pos</a>;      <span class="comment">///&lt; value positions</span></div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">  354</a></span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">_val_pos_inv</a>;  <span class="comment">///&lt; value position inverse, i.e. inv(_val_pos)</span></div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">  355</a></span>&#160;  <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">iarray_type</a> <a class="code" href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">_node_counts</a>;  <span class="comment">///&lt; number of nodes per list</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// TODO do we need to use size_type for storing the positions? This will</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// almost double the memory usage for if index_type is just 32bit,</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// assuming that size_t is 64bit, which is common.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;};</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}  <span class="comment">// namespace internal</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">/// \class AugCRS</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">/// \brief Augmented CRS data structure</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">/// \tparam CrsType A CRS type instantiation</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">/// \sa AugCCS</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">/// \note This class inherits from CRS</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/// \ingroup ds</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CrsType&gt;</div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html">  370</a></span>&#160;<span class="keyword">class</span> <a class="code" href="classhif_1_1AugCRS.html">AugCRS</a> : <span class="keyword">public</span> CrsType,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;               <span class="keyword">public</span> <a class="code" href="namespacehif_1_1internal.html">internal</a>::<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html">AugmentedCore</a>&lt;<span class="keyword">typename</span> CrsType::<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html">index_type</a>&gt; {</div><div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">  372</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="namespacehif_1_1internal.html">internal</a>::<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html">AugmentedCore</a>&lt;<span class="keyword">typename</span> CrsType::<a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">index_type</a>&gt; <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a6ce7edfe63ecf5fec10bfb14b1473f4b">  375</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classhif_1_1AugCRS.html">AugCRS</a>                           <a class="code" href="classhif_1_1AugCRS.html#a6ce7edfe63ecf5fec10bfb14b1473f4b">this_type</a>;         <span class="comment">///&lt; aug crs type</span></div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">  376</a></span>&#160;  <span class="keyword">typedef</span> CrsType                          <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>;          <span class="comment">///&lt; crs</span></div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a490c1c3a8b600a4d8b79ec8f7a34b776">  377</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::<a class="code" href="classhif_1_1AugCRS.html#a490c1c3a8b600a4d8b79ec8f7a34b776">other_type</a>    <a class="code" href="classhif_1_1AugCRS.html#a490c1c3a8b600a4d8b79ec8f7a34b776">ccs_type</a>;          <span class="comment">///&lt; ccs</span></div><div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">  378</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::<a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a>     <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a>;         <span class="comment">///&lt; size</span></div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">  379</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::<a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a>      <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a>;       <span class="comment">///&lt; index array</span></div><div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">  380</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a>::<a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">value_type</a> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a>;        <span class="comment">///&lt; index type</span></div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a1b8c766a117a9a10c81f36990173cb4e">  381</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::<a class="code" href="classhif_1_1AugCRS.html#a1b8c766a117a9a10c81f36990173cb4e">value_type</a>    <a class="code" href="classhif_1_1AugCRS.html#a1b8c766a117a9a10c81f36990173cb4e">value_type</a>;        <span class="comment">///&lt; value</span></div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a06cac9588b9dc9a2137fabcfd863e952">  382</a></span>&#160;  <span class="keyword">constexpr</span> <span class="keyword">static</span> <span class="keywordtype">bool</span>                    <a class="code" href="classhif_1_1AugCRS.html#a06cac9588b9dc9a2137fabcfd863e952">ROW_MAJOR</a> = <span class="keyword">true</span>;  <span class="comment">///&lt; crs flag</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a909bc75b3f24d211f4160acc66c904da">  385</a></span>&#160;  <span class="keyword">constexpr</span> <span class="keyword">static</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> <a class="code" href="classhif_1_1AugCRS.html#a909bc75b3f24d211f4160acc66c904da">_NIL</a> = <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_NIL;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">/// \brief default constructor</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="classhif_1_1AugCRS.html#a69bb74a2ccb314f1151adc2b04f26e96">AugCRS</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">/// \brief constructor for general matrix</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">/// \param[in] nrows number of rows</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">/// \param[in] ncols number of columns</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">/// \param[in] nnz ignored if zero (default)</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">/// \param[in] reserve if \a true (default), reserve spaces</span></div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a4f560c3f3d635b379495e601aea4441b">  396</a></span>&#160;  <a class="code" href="classhif_1_1AugCRS.html#a4f560c3f3d635b379495e601aea4441b">AugCRS</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> nrows, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> ncols, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> nnz = 0u,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;         <span class="keywordtype">bool</span> reserve = <span class="keyword">true</span>)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      : <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>(nrows, ncols, nnz, reserve), <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>(ncols, nnz, reserve) {}</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">/// \brief constructor to either clone or shallow copy another AugCRS</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">/// \param[in] other another augmented CRS</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">/// \param[in] clone if \a false (default), then do shallow copy</span></div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a1134da06503ae9bb478ed3a130ab01cf">  403</a></span>&#160;  <a class="code" href="classhif_1_1AugCRS.html#a1134da06503ae9bb478ed3a130ab01cf">AugCRS</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#a6ce7edfe63ecf5fec10bfb14b1473f4b">this_type</a> &amp;other, <span class="keywordtype">bool</span> clone = <span class="keyword">false</span>)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      : <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>(other, clone), <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>(other, clone) {}</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// default stuffs</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="classhif_1_1AugCRS.html#a6b1c56fda389e16e58345767ef67e771">AugCRS</a>(<a class="code" href="classhif_1_1AugCRS.html#a6ce7edfe63ecf5fec10bfb14b1473f4b">this_type</a> &amp;&amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="code" href="classhif_1_1AugCRS.html#a6ce7edfe63ecf5fec10bfb14b1473f4b">this_type</a> &amp;<a class="code" href="classhif_1_1AugCRS.html#a657554b72296da31accb49b15420867f">operator</a>=(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#a6ce7edfe63ecf5fec10bfb14b1473f4b">this_type</a> &amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <a class="code" href="classhif_1_1AugCRS.html#a6ce7edfe63ecf5fec10bfb14b1473f4b">this_type</a> &amp;<a class="code" href="classhif_1_1AugCRS.html#ad8a516b730c50b8cbb0fdabc72373146">operator</a>=(<a class="code" href="classhif_1_1AugCRS.html#a6ce7edfe63ecf5fec10bfb14b1473f4b">this_type</a> &amp;&amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">/// \brief build augmented data structure based on mature CRS matrices</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">/// \param[in] crs mature CRS system</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">/// \param[in] clone if \a false (default), \a crs will be shallow copied</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">/// \warning Advanced usage routine!</span></div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#aebf6c4ec5774bf7a38db33750a4edaa9">  415</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#aebf6c4ec5774bf7a38db33750a4edaa9">build_aug</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a> &amp;crs, <span class="keywordtype">bool</span> clone = <span class="keyword">false</span>) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    !clone ? <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::operator=(crs)</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;           : <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::operator=(<a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>(crs, <span class="keyword">true</span>));</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(crs.status() == <a class="code" href="group__ds.html#ggae8ba63363282e4e9bfefc285cb31dbaba5843809d8b3589cc095aa56239f21d0d">DATA_UNDEF</a>, <span class="stringliteral">&quot;undefined data input matrix&quot;</span>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(crs.nrows() + 1u != crs.row_start().size(),</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                 <span class="stringliteral">&quot;row-start array size (%zd) does not agree with nrows (%zd)&quot;</span><a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                 crs.row_start().size()<a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a> crs.nrows());</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(crs.nnz() != crs.col_ind().size(), <span class="stringliteral">&quot;inconsistent nnz&quot;</span>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_build_aug(crs.ncols(), crs.row_start(), crs.col_ind());</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">/// \brief build augmented data structure based on mature CRS</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">/// \param[in] crs temp CRS system</span></div><div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a9742dc6736947d3242d52ef93222ec67">  428</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#a9742dc6736947d3242d52ef93222ec67">build_aug</a>(<a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a> &amp;&amp;crs) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::operator=(crs);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(crs.status() == <a class="code" href="group__ds.html#ggae8ba63363282e4e9bfefc285cb31dbaba5843809d8b3589cc095aa56239f21d0d">DATA_UNDEF</a>, <span class="stringliteral">&quot;undefined data input matrix&quot;</span>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(crs.nrows() + 1u != crs.row_start().size(),</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                 <span class="stringliteral">&quot;row-start array size (%zd) does not agree with nrows (%zd)&quot;</span><a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                 crs.row_start().size()<a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a> crs.nrows());</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(crs.nnz() != crs.col_ind().size(), <span class="stringliteral">&quot;inconsistent nnz&quot;</span>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_build_aug(crs.ncols(), crs.row_start(), crs.col_ind());</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">/// \brief build augmented data structured based on mature CCS matrices</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">/// \param[in] ccs mature CCS system</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">/// \warning Advanced usage routine</span></div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#adaf160f87ba653581297de4bbeb4e94d">  441</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#adaf160f87ba653581297de4bbeb4e94d">build_aug</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#a490c1c3a8b600a4d8b79ec8f7a34b776">ccs_type</a> &amp;ccs) {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::operator=(<a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>(ccs));</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(ccs.status() == <a class="code" href="group__ds.html#ggae8ba63363282e4e9bfefc285cb31dbaba5843809d8b3589cc095aa56239f21d0d">DATA_UNDEF</a>, <span class="stringliteral">&quot;undefined data input matrix&quot;</span>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(nrows() + 1u != <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::row_start().size(),</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                 <span class="stringliteral">&quot;row-start array size (%zd) does not agree with nrows (%zd)&quot;</span><a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                 <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::row_start().size()<a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a> nrows());</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(<a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::nnz() != col_ind.size(), <span class="stringliteral">&quot;inconsistent nnz&quot;</span>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_build_aug(ncols(), <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::row_start(), col_ind());</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">/// \brief given column index, get the starting column handle</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">/// \param[in] col column index</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">/// \return first column handle in the augmented data structure</span></div><div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">  454</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> <a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">start_col_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> col) <span class="keyword">const</span> {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_start_node(col);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">/// \brief unified interface to get starting augmented ID</span></div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a117cf4913381c33a99b5f4c09ea8f9b6">  459</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> <a class="code" href="classhif_1_1AugCRS.html#a117cf4913381c33a99b5f4c09ea8f9b6">start_aug_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> col) <span class="keyword">const</span> {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">start_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">(</a>col<a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">)</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">/// \brief given a column handle, get its next location</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">/// \param[in] col_id column handle/ID</span></div><div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">  465</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> <a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">next_col_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> col_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_next_node(col_id);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">/// \brief unified interface for advancing augmented ID</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">/// \param[in] aug_id augmented ID</span></div><div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#ab3ab9a3f458b0087137e15333950d936">  471</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> <a class="code" href="classhif_1_1AugCRS.html#ab3ab9a3f458b0087137e15333950d936">next_aug_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> aug_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">next_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">(</a>aug_id<a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">)</a>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">/// \brief given a column handle/ID, get its corresponding row index</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">/// \param[in] col_id column handle/ID</span></div><div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">  477</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> <a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">row_idx</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> col_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_ind(col_id);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">/// \brief unified interface for getting primary index</span></div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a9a57c0381a4cac2a24dea052157e043b">  482</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> <a class="code" href="classhif_1_1AugCRS.html#a9a57c0381a4cac2a24dea052157e043b">primary_idx</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> aug_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">row_idx</a><a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">(</a>aug_id<a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">)</a>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">/// \brief reserve space for nnz arrays</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">/// \param[in] nnz total number of nonzeros</span></div><div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#ab24fa3d0d593128dc9658b1a2fa6f690">  488</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#ab24fa3d0d593128dc9658b1a2fa6f690">reserve</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> nnz) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::reserve(nnz);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::reserve(nnz);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::is_nil;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::val_pos_idx;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::col_ind;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::ncols;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::nrows;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::vals;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">/// \brief get value with col id</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">/// \param[in] col_id column handle/ID</span></div><div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a3222e9a7c220cddad2257acc132151fd">  502</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#a1b8c766a117a9a10c81f36990173cb4e">value_type</a> <a class="code" href="classhif_1_1AugCRS.html#a3222e9a7c220cddad2257acc132151fd">val_from_col_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> col_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// this is how to get value</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">return</span> vals()[val_pos_idx(col_id)];</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">/// \brief unified interface for getting value from augmented ID</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">/// \param[in] aug_id augmented ID</span></div><div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#acd03c489cd2b0af6d53f15b69bbe3da4">  509</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#a1b8c766a117a9a10c81f36990173cb4e">value_type</a> <a class="code" href="classhif_1_1AugCRS.html#acd03c489cd2b0af6d53f15b69bbe3da4">val_from_aug_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> aug_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a3222e9a7c220cddad2257acc132151fd">val_from_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a3222e9a7c220cddad2257acc132151fd">(</a>aug_id<a class="code" href="classhif_1_1AugCRS.html#a3222e9a7c220cddad2257acc132151fd">)</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">/// \brief get the total number of nonzeros columnwise</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">/// \param[in] col column index</span></div><div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#aa4b7297f8d0d4af7bc6faacbef493cab">  515</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> <a class="code" href="classhif_1_1AugCRS.html#aa4b7297f8d0d4af7bc6faacbef493cab">nnz_in_col</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> col) <span class="keyword">const</span> {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_nodes_in_list(col);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">/// \brief unified interface for getting in secondary (col) direction</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">/// \param[in] col column index</span></div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a14fded53d4e7b2b4ebda43a2420978d7">  521</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> <a class="code" href="classhif_1_1AugCRS.html#a14fded53d4e7b2b4ebda43a2420978d7">nnz_in_secondary</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> col) <span class="keyword">const</span> {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#aa4b7297f8d0d4af7bc6faacbef493cab">nnz_in_col</a><a class="code" href="classhif_1_1AugCRS.html#aa4b7297f8d0d4af7bc6faacbef493cab">(</a>col<a class="code" href="classhif_1_1AugCRS.html#aa4b7297f8d0d4af7bc6faacbef493cab">)</a>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">/// \brief interchange two columns</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">/// \note This is the core operation for augmented data structure</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">/// \param[in] i i-th column</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">/// \param[in] k k-th column</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="comment">///</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">/// Mathematically, after calling this routine, the i-th and k-th columns</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">/// will be interchanged. The total complexity of this routine is linear with</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">/// respect to the total number of nonzeros in columns \a i and \a k.</span></div><div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#ab5a1d953e8dab796e7c08afcc702e8c1">  533</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#ab5a1d953e8dab796e7c08afcc702e8c1">interchange_cols</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> i, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> k) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(i &lt; ncols(), <span class="stringliteral">&quot;%zd exceeds max ncols&quot;</span>, i);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(k &lt; ncols(), <span class="stringliteral">&quot;%zd exceeds max ncols&quot;</span>, k);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> (i == k) <span class="keywordflow">return</span>;  <span class="comment">// fast return if possible</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">// get the starting handles/IDs</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> i_col_id = <a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">start_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">(</a>i<a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">)</a>, k_col_id = <a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">start_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">(</a>k<a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">)</a>;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="comment">// determine current statuses</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> i_empty = is_nil(i_col_id), k_empty = is_nil(k_col_id);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="comment">// break if both of them are empty/nil (meaning finished)</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">if</span> (i_empty &amp;&amp; k_empty) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="comment">// get the row indices for i and k, as well as the value positions, which</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="comment">// are needed to locate the corresponding locations of the vals array</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> i_row = !i_empty ? <a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">row_idx</a><a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">(</a>i_col_id<a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">)</a> : <a class="code" href="classhif_1_1AugCRS.html#a909bc75b3f24d211f4160acc66c904da">_NIL</a>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> k_row = !k_empty ? <a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">row_idx</a><a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">(</a>k_col_id<a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">)</a> : <a class="code" href="classhif_1_1AugCRS.html#a909bc75b3f24d211f4160acc66c904da">_NIL</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> i_vp  = !i_empty ? val_pos_idx(i_col_id) : <a class="code" href="classhif_1_1AugCRS.html#a909bc75b3f24d211f4160acc66c904da">_NIL</a>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> k_vp  = !k_empty ? val_pos_idx(k_col_id) : <a class="code" href="classhif_1_1AugCRS.html#a909bc75b3f24d211f4160acc66c904da">_NIL</a>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="keywordflow">if</span> (i_row == k_row) {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">// both rows exists</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="comment">// first, swap value array in CRS</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        std::swap(vals()[i_vp], vals()[k_vp]);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="comment">// then swap the val position in AugCRS</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_swap_val_pos_exp(i_vp, k_vp);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="comment">// finally, advance to next handles for both i and k</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        i_col_id = <a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">next_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">(</a>i_col_id<a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">)</a>;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        k_col_id = <a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">next_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">(</a>k_col_id<a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">)</a>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i_row &lt; k_row || is_nil(k_row)) {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">// rotate i_row to k_row</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">// get the local row range by using standard CRS API</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="comment">// then get the position of i-col by using the value position</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keyword">auto</span> i_col_itr_first = <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::col_ind_begin(i_row),</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;             i_col_itr_last  = <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::col_ind_end(i_row),</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;             i_col_itr_pos   = <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::col_ind().begin() + i_vp;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(std::is_sorted(i_col_itr_first, i_col_itr_last),</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                   <span class="stringliteral">&quot;%zd is not a sorted row&quot;</span>, (size_type)i_row);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="comment">// since k is missing, we need to find the nearest position of k</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">// O(log n)</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">// NOTE we use lower-bound operation, thus, given the following example</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">//  [1 4 8]</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="comment">// if we want to find 0, then index 0 is returned</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="comment">// if we want to find 2, then index 1 is returned</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="comment">// if we want to find 5, then index 2 is returned</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="comment">// if we want to find 9, then index 3 (pass-of-end) is returned</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keyword">auto</span> srch_info = find_sorted(i_col_itr_first, i_col_itr_last, k);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">// we should not find the value, cuz if true, it should to the code</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="comment">// block above</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <a class="code" href="group__util.html#ga0925a13068fc1e31f6a7323a12a56ebf">hif_debug_code</a>(<span class="keywordtype">bool</span> k_col_should_not_exit = !srch_info.first);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(k_col_should_not_exit, <span class="stringliteral">&quot;see prefix, failed with row %zd&quot;</span>,</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                   (size_type)i_row);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="comment">// now, assign new value to i-col</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        *i_col_itr_pos              = k;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span>      do_left_rot = i_col_itr_pos &lt; srch_info.second;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> n = std::abs(i_col_itr_pos - srch_info.second);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="comment">// since we use lower bound, it may happen that n == 0</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">if</span> (n) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          <span class="keywordflow">if</span> (do_left_rot) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_rotate_val_pos_left(n, i_vp);  <span class="comment">// O(n)</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            rotate_left(n, i_vp, col_ind());       <span class="comment">// O(n)</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            rotate_left(n, i_vp, vals());          <span class="comment">// O(n)</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="comment">// NOTE that +1 due to using lower_bound</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_rotate_val_pos_right(n + 1, i_vp);  <span class="comment">// O(n)</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            rotate_right(n + 1, i_vp, col_ind());       <span class="comment">// O(n)</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            rotate_right(n + 1, i_vp, vals());          <span class="comment">// O(n)</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">// the indices should still be sorted</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="group__util.html#ga0925a13068fc1e31f6a7323a12a56ebf">hif_debug_code</a>(i_col_itr_first = crs_type::col_ind_begin(i_row);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                       i_col_itr_last  = crs_type::col_ind_end(i_row));</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(std::is_sorted(i_col_itr_first, i_col_itr_last),</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                   <span class="stringliteral">&quot;%zd is not a sorted row (after rotation)&quot;</span>,</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                   (size_type)i_row);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment">// keep k, advance i</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        i_col_id = <a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">next_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">(</a>i_col_id<a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">)</a>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment">// rotate k_row to i_row, this is exactly the same as above, just change</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">// i to k</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keyword">auto</span> k_col_itr_first = <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::col_ind_begin(k_row),</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;             k_col_itr_last  = <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::col_ind_end(k_row),</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;             k_col_itr_pos   = <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::col_ind().begin() + k_vp;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(std::is_sorted(k_col_itr_first, k_col_itr_last),</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                   <span class="stringliteral">&quot;%zd is not a sorted row&quot;</span>, (size_type)k_row);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">// O(log n)</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keyword">auto</span> srch_info = find_sorted(k_col_itr_first, k_col_itr_last, i);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <a class="code" href="group__util.html#ga0925a13068fc1e31f6a7323a12a56ebf">hif_debug_code</a>(<span class="keywordtype">bool</span> i_col_should_not_exit = !srch_info.first);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(i_col_should_not_exit, <span class="stringliteral">&quot;see prefix, failed with row %zd&quot;</span>,</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                   (size_type)k_row);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="comment">// assign new column index to k-col</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        *k_col_itr_pos              = i;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span>      do_left_rot = k_col_itr_pos &lt; srch_info.second;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> n = std::abs(k_col_itr_pos - srch_info.second);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">if</span> (n) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          <span class="keywordflow">if</span> (do_left_rot) {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_rotate_val_pos_left(n, k_vp);  <span class="comment">// O(n)</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            rotate_left(n, k_vp, col_ind());       <span class="comment">// O(n)</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            rotate_left(n, k_vp, vals());          <span class="comment">// O(n)</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="comment">// NOTE that +1 due to using lower_bound</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_rotate_val_pos_right(n + 1, k_vp);  <span class="comment">// O(n)</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            rotate_right(n + 1, k_vp, col_ind());       <span class="comment">// O(n)</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            rotate_right(n + 1, k_vp, vals());          <span class="comment">// O(n)</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;          }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="comment">// after rotation, the indices should be sorted as well</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <a class="code" href="group__util.html#ga0925a13068fc1e31f6a7323a12a56ebf">hif_debug_code</a>(k_col_itr_first = crs_type::col_ind_begin(k_row);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                       k_col_itr_last  = crs_type::col_ind_end(k_row));</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(std::is_sorted(k_col_itr_first, k_col_itr_last),</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                   <span class="stringliteral">&quot;%zd is not a sorted row (after rotation)&quot;</span>,</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                   (size_type)k_row);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="comment">// keep i, advance k</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        k_col_id = <a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">next_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">(</a>k_col_id<a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">)</a>;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">// finally, swap the head and tail link list</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_interchange_ik_head_tail(i, k);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment">/// \brief unified interface for interchanging entries</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">/// \sa interchange_cols</span></div><div class="line"><a name="l00652"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a0d0c4cd0656cfe0a8fb42249f98a8d3d">  652</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#a0d0c4cd0656cfe0a8fb42249f98a8d3d">interchange_entries</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> i, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> k) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#ab5a1d953e8dab796e7c08afcc702e8c1">interchange_cols</a><a class="code" href="classhif_1_1AugCRS.html#ab5a1d953e8dab796e7c08afcc702e8c1">(</a>i<a class="code" href="classhif_1_1AugCRS.html#ab5a1d953e8dab796e7c08afcc702e8c1">,</a> k<a class="code" href="classhif_1_1AugCRS.html#ab5a1d953e8dab796e7c08afcc702e8c1">)</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="comment">/// \brief defer a column to the end</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="comment">/// \param[in] from which column to defer</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">/// \param[in] to the current pass-of-end column index</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">/// \warning the parameter \a to must be current pass-of-last column</span></div><div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#adb8192dcce19d2d8d65f37b1ab4680ac">  660</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#adb8192dcce19d2d8d65f37b1ab4680ac">defer_col</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> from, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> to) {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(from &lt; ncols(), <span class="stringliteral">&quot;%zd exceeds max ncols&quot;</span>, from);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(to &lt; ncols(), <span class="stringliteral">&quot;%zd exceeds max ncols&quot;</span>, to);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(from &lt; to, <span class="stringliteral">&quot;from (%zd) should strictly less than to (%zd)&quot;</span>, from,</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;               to);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(is_nil(start_col_id(to)), <span class="stringliteral">&quot;destination must be empty!&quot;</span>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">index_type</a> col_id = <a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">start_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">(</a>from<a class="code" href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">)</a>;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">while</span> (!is_nil(col_id)) {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> row = <a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">row_idx</a><a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">(</a>col_id<a class="code" href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">)</a>;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> vp  = val_pos_idx(col_id);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keyword">auto</span>       itr = col_ind().begin() + vp;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(itr != crs_type::col_ind_end(row), <span class="stringliteral">&quot;fatal&quot;</span>);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="comment">// assign &quot;defer&quot; column index</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      *itr              = to;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> n = <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::col_ind_end(row) - itr;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      rotate_left(n, vp, col_ind());</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      rotate_left(n, vp, vals());</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_rotate_val_pos_left(n, vp);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      col_id = <a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">next_col_id</a><a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">(</a>col_id<a class="code" href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">)</a>;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// NOTE that the start/end should not been visited, thus we can directly</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">// reuse the routine &quot;swap&quot;</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_interchange_ik_head_tail(from, to);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="comment">/// \brief unified interface for deferring</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="comment">/// \sa defer_col</span></div><div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#abcf385406b6d40e2d4ca580634138e42">  687</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#abcf385406b6d40e2d4ca580634138e42">defer_entry</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> from, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> to) {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#adb8192dcce19d2d8d65f37b1ab4680ac">defer_col</a><a class="code" href="classhif_1_1AugCRS.html#adb8192dcce19d2d8d65f37b1ab4680ac">(</a>from<a class="code" href="classhif_1_1AugCRS.html#adb8192dcce19d2d8d65f37b1ab4680ac">,</a> to<a class="code" href="classhif_1_1AugCRS.html#adb8192dcce19d2d8d65f37b1ab4680ac">)</a>;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// utilities</span></div><div class="line"><a name="l00692"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#ade956f41eb20c1d9da017e1566e37314">  692</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCRS.html#ade956f41eb20c1d9da017e1566e37314">row_ind</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_inds; }</div><div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a5c50e7cddbeb058c679ba095e6753989">  693</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;<a class="code" href="classhif_1_1AugCRS.html#a5c50e7cddbeb058c679ba095e6753989">row_ind</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_inds; }</div><div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a47a4edf544aa78efe8b085aad20f8397">  694</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCRS.html#a47a4edf544aa78efe8b085aad20f8397">col_start</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_start; }</div><div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a402d7bf3e3720838e69c6e41347275c2">  695</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;<a class="code" href="classhif_1_1AugCRS.html#a402d7bf3e3720838e69c6e41347275c2">col_start</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_start; }</div><div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a7fefc90dce79e9e6ac9a95ad7b4d70c1">  696</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCRS.html#a7fefc90dce79e9e6ac9a95ad7b4d70c1">col_end</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_end; }</div><div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a60a3cf39427b9113c00f40634c0130c0">  697</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;<a class="code" href="classhif_1_1AugCRS.html#a60a3cf39427b9113c00f40634c0130c0">col_end</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_end; }</div><div class="line"><a name="l00698"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#accd26bafdc942d5511630ebf75ae4236">  698</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCRS.html#accd26bafdc942d5511630ebf75ae4236">col_next</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_next; }</div><div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a36b857e8ed4b03ea5b469fced8f1045f">  699</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;<a class="code" href="classhif_1_1AugCRS.html#a36b857e8ed4b03ea5b469fced8f1045f">col_next</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_next; }</div><div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#ad2efedd2b5ff9fd3d71fcc02165b749e">  700</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCRS.html#ad2efedd2b5ff9fd3d71fcc02165b749e">col_counts</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_counts; }</div><div class="line"><a name="l00701"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a83d99b27b92ed82ddc9f00a8d1bb2623">  701</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">iarray_type</a> &amp;<a class="code" href="classhif_1_1AugCRS.html#a83d99b27b92ed82ddc9f00a8d1bb2623">col_counts</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_node_counts; }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="comment">/// \brief begin to assemble rows</span></div><div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a52e4a1c93254ec6e473a2b574a2fd44b">  704</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#a52e4a1c93254ec6e473a2b574a2fd44b">begin_assemble_rows</a>() {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::begin_assemble_rows();</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::_begin_assemble_nodes(ncols());</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">/// \brief push back a row with column indices</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="comment">/// \tparam Iter iterator type</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="comment">/// \tparam ValueArray dense value array</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">/// \param[in] row current row index (C-based)</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="comment">/// \param[in] first starting iterator</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">/// \param[in] last pass-of-end iterator</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">/// \param[in] v dense value array, the value can be queried from indices</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Iter, <span class="keyword">class</span> ValueArray&gt;</div><div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a6217030c834990948fe8d99b62a3c6e4">  717</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#a6217030c834990948fe8d99b62a3c6e4">push_back_row</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> row, Iter first, Iter last,</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                            <span class="keyword">const</span> ValueArray &amp;v) {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::<span class="keyword">template</span> push_back_row&lt;Iter, ValueArray&gt;(row, first, last, v);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::<span class="keyword">template</span> _push_back_nodes&lt;Iter&gt;(row, first, last);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="comment">/// \brief push back a row with two lists of column indices</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">/// \tparam Iter1 iterator type</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">/// \tparam ValueArray1 dense value array</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">/// \tparam Iter2 iterator type</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="comment">/// \tparam ValueArray2 dense value array</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="comment">/// \param[in] row current row index (c-based)</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">/// \param[in] first1 starting iterator of list 1</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">/// \param[in] last1 pass-of-end iterator of list 1</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">/// \param[in] v1 dense value array for list 1</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="comment">/// \param[in] first2 starting iterator of list 2</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="comment">/// \param[in] last2 pass-of-end iterator of list 2</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="comment">/// \param[in] v2 dense value array for list 2</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Iter1, <span class="keyword">class</span> ValueArray1, <span class="keyword">class</span> Iter2, <span class="keyword">class</span> ValueArray2&gt;</div><div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="classhif_1_1AugCRS.html#a2478629d5942e2100112dcd0b4186213">  736</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCRS.html#a2478629d5942e2100112dcd0b4186213">push_back_row</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">size_type</a> row, Iter1 first1, Iter1 last1,</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                            <span class="keyword">const</span> ValueArray1 &amp;v1, Iter2 first2, Iter2 last2,</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                            <span class="keyword">const</span> ValueArray2 &amp;v2) {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">crs_type</a>::push_back_row(row, first1, last1, v1, first2, last2, v2);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::<span class="keyword">template</span> _push_back_nodes&lt;Iter1&gt;(row, first1, last1);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">_base</a>::<span class="keyword">template</span> _push_back_nodes&lt;Iter2&gt;(row, first2, last2);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;};</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">/// \class AugCCS</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">/// \brief Augmented CCS data structure</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">/// \tparam CcsType A CCS type instantiation</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">/// \sa AugCRS</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">/// \note This class inherits from CCS</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">/// \ingroup ds</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CcsType&gt;</div><div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html">  752</a></span>&#160;<span class="keyword">class</span> <a class="code" href="classhif_1_1AugCCS.html">AugCCS</a> : <span class="keyword">public</span> CcsType,</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;               <span class="keyword">public</span> <a class="code" href="namespacehif_1_1internal.html">internal</a>::<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html">AugmentedCore</a>&lt;<span class="keyword">typename</span> CcsType::<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html">index_type</a>&gt; {</div><div class="line"><a name="l00754"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">  754</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="namespacehif_1_1internal.html">internal</a>::<a class="code" href="classhif_1_1internal_1_1AugmentedCore.html">AugmentedCore</a>&lt;<span class="keyword">typename</span> CcsType::<a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">index_type</a>&gt; <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00757"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a7b6dc6c46490ff3b31491f15431d31d2">  757</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classhif_1_1AugCCS.html">AugCCS</a>                           <a class="code" href="classhif_1_1AugCCS.html#a7b6dc6c46490ff3b31491f15431d31d2">this_type</a>;    <span class="comment">///&lt; this</span></div><div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">  758</a></span>&#160;  <span class="keyword">typedef</span> CcsType                          <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>;     <span class="comment">///&lt; ccs type</span></div><div class="line"><a name="l00759"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a19bf4ec9c50e894d54c188795fad3ca2">  759</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::<a class="code" href="classhif_1_1AugCCS.html#a19bf4ec9c50e894d54c188795fad3ca2">other_type</a>    <a class="code" href="classhif_1_1AugCCS.html#a19bf4ec9c50e894d54c188795fad3ca2">crs_type</a>;     <span class="comment">///&lt; crs</span></div><div class="line"><a name="l00760"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">  760</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::<a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a>     <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a>;    <span class="comment">///&lt; size</span></div><div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">  761</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::<a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a>      <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a>;  <span class="comment">///&lt; index array</span></div><div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">  762</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a>::<a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">value_type</a> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a>;   <span class="comment">///&lt; index type</span></div><div class="line"><a name="l00763"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a9d0d3c3a1cc5fdbcf47b4765b1c27c75">  763</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::<a class="code" href="classhif_1_1AugCCS.html#a9d0d3c3a1cc5fdbcf47b4765b1c27c75">value_type</a>    <a class="code" href="classhif_1_1AugCCS.html#a9d0d3c3a1cc5fdbcf47b4765b1c27c75">value_type</a>;   <span class="comment">///&lt; value</span></div><div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a393aeff4866810a09bf831cfeded2cbf">  764</a></span>&#160;  <span class="keyword">constexpr</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classhif_1_1AugCCS.html#a393aeff4866810a09bf831cfeded2cbf">ROW_MAJOR</a> = <span class="keyword">false</span>;               <span class="comment">///&lt; row major flag</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#ac30a2fb25a405f413543e3f3efa40916">  767</a></span>&#160;  <span class="keyword">constexpr</span> <span class="keyword">static</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> <a class="code" href="classhif_1_1AugCCS.html#ac30a2fb25a405f413543e3f3efa40916">_NIL</a> = <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_NIL;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">/// \brief default constructor</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <a class="code" href="classhif_1_1AugCCS.html#a99b5fcc42f9b07bc30d0fb03d449e4a7">AugCCS</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="comment">/// \brief constructor for general matrices</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">/// \param[in] nrows number of rows</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">/// \param[in] ncols number of columns</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">/// \param[in] nnz ignored if zero (default)</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="comment">/// \param[in] reserve if \a true (default), then reserve spaces</span></div><div class="line"><a name="l00778"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a55b0fbc8cc5e0e7e34dc0d7d306ed9b7">  778</a></span>&#160;  <a class="code" href="classhif_1_1AugCCS.html#a55b0fbc8cc5e0e7e34dc0d7d306ed9b7">AugCCS</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> nrows, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> ncols, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> nnz = 0u,</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;         <span class="keywordtype">bool</span> reserve = <span class="keyword">true</span>)</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      : <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>(nrows, ncols, nnz, reserve), <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>(nrows, nnz, reserve) {}</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="comment">/// \brief constructor to either clone or shallow copy another AugCCS</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="comment">/// \param[in] other another augmented CCS</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">/// \param[in] clone if \a false (default), then do shallow copy</span></div><div class="line"><a name="l00785"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a5c2aa0655e4781cd12763cafb58498aa">  785</a></span>&#160;  <a class="code" href="classhif_1_1AugCCS.html#a5c2aa0655e4781cd12763cafb58498aa">AugCCS</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a7b6dc6c46490ff3b31491f15431d31d2">this_type</a> &amp;other, <span class="keywordtype">bool</span> clone = <span class="keyword">false</span>)</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      : <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>(other, clone), <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>(other, clone) {}</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="comment">// default stuffs</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <a class="code" href="classhif_1_1AugCCS.html#a7f44f4df25b1a6ca0616385489709bd2">AugCCS</a>(<a class="code" href="classhif_1_1AugCCS.html#a7b6dc6c46490ff3b31491f15431d31d2">this_type</a> &amp;&amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <a class="code" href="classhif_1_1AugCCS.html#a7b6dc6c46490ff3b31491f15431d31d2">this_type</a> &amp;<a class="code" href="classhif_1_1AugCCS.html#af1b7e497febdaa856e77afa78c1704da">operator</a>=(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a7b6dc6c46490ff3b31491f15431d31d2">this_type</a> &amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <a class="code" href="classhif_1_1AugCCS.html#a7b6dc6c46490ff3b31491f15431d31d2">this_type</a> &amp;<a class="code" href="classhif_1_1AugCCS.html#a144be5955d9454dfac861bfe65926b48">operator</a>=(<a class="code" href="classhif_1_1AugCCS.html#a7b6dc6c46490ff3b31491f15431d31d2">this_type</a> &amp;&amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="comment">/// \brief build augmented data structure based on mature CCS matrices</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">/// \param[in] ccs mature CCS system</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="comment">/// \param[in] clone if \a false (default), \a crs will be shallow copied</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="comment">/// \warning Advanced usage routine!</span></div><div class="line"><a name="l00797"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a864067248afb2166f6801766e9271c09">  797</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#a864067248afb2166f6801766e9271c09">build_aug</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a> &amp;ccs, <span class="keywordtype">bool</span> clone = <span class="keyword">false</span>) {</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    !clone ? <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::operator=(ccs)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;           : <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::operator=(<a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>(ccs, <span class="keyword">true</span>));</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(ccs.status() == <a class="code" href="group__ds.html#ggae8ba63363282e4e9bfefc285cb31dbaba5843809d8b3589cc095aa56239f21d0d">DATA_UNDEF</a>, <span class="stringliteral">&quot;undefined data input&quot;</span>);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        ccs.ncols() + 1u != ccs.col_start().size(),</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="stringliteral">&quot;inconsistent sizes between ncols (%zd) and col-start size (%zd)&quot;</span><a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        ccs.ncols()<a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a> ccs.col_start().size());</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(ccs.nnz() != ccs.row_ind().size(), <span class="stringliteral">&quot;inconsistent nnz&quot;</span>);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_build_aug(ccs.nrows(), ccs.col_start(), ccs.row_ind());</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="comment">/// \brief build augmented data structure based on mature CCS</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="comment">/// \param[in] ccs temp CCS system</span></div><div class="line"><a name="l00811"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a75e1cf125c3d66d4e80bd3290272385d">  811</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#a75e1cf125c3d66d4e80bd3290272385d">build_aug</a>(<a class="code" href="classhif_1_1AugCCS.html#a19bf4ec9c50e894d54c188795fad3ca2">crs_type</a> &amp;&amp;ccs) {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::operator=(ccs);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(ccs.status() == <a class="code" href="group__ds.html#ggae8ba63363282e4e9bfefc285cb31dbaba5843809d8b3589cc095aa56239f21d0d">DATA_UNDEF</a>, <span class="stringliteral">&quot;undefined data input&quot;</span>);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        ccs.ncols() + 1u != ccs.col_start().size(),</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="stringliteral">&quot;inconsistent sizes between ncols (%zd) and col-start size (%zd)&quot;</span><a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        ccs.ncols()<a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a> ccs.col_start().size());</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(ccs.nnz() != ccs.row_ind().size(), <span class="stringliteral">&quot;inconsistent nnz&quot;</span>);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_build_aug(ccs.nrows(), ccs.col_start(), ccs.row_ind());</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="comment">/// \brief build augmented data structured based on mature CRS matrices</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">/// \param[in] crs mature CRS system</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="comment">/// \warning Advanced usage routine</span></div><div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a1a2fab9eda19cfe8260ee8dcf8524eed">  825</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#a1a2fab9eda19cfe8260ee8dcf8524eed">build_aug</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a19bf4ec9c50e894d54c188795fad3ca2">crs_type</a> &amp;crs) {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::operator=(<a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>(crs));</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(crs.status() == <a class="code" href="group__ds.html#ggae8ba63363282e4e9bfefc285cb31dbaba5843809d8b3589cc095aa56239f21d0d">DATA_UNDEF</a>, <span class="stringliteral">&quot;undefined data input&quot;</span>);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        ncols() + 1u != <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::col_start().size(),</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="stringliteral">&quot;inconsistent sizes between ncols (%zd) and col-start size (%zd)&quot;</span><a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        ncols()<a class="code" href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">,</a> <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::col_start().size());</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a>(<a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::nnz() != row_ind().size(), <span class="stringliteral">&quot;inconsistent nnz&quot;</span>);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_build_aug(nrows(), <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::col_start(), row_ind());</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">/// \brief given row index, get the starting row handle/ID</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">/// \param[in] row row index</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">/// \return first row handle in the augmented data structure</span></div><div class="line"><a name="l00839"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">  839</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> <a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">start_row_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> row) <span class="keyword">const</span> {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_start_node(row);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">/// \brief unified interface for getting starting augmented ID</span></div><div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a4172df44084aa5565f87ea5c200a8392">  844</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> <a class="code" href="classhif_1_1AugCCS.html#a4172df44084aa5565f87ea5c200a8392">start_aug_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> row) <span class="keyword">const</span> {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">start_row_id</a><a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">(</a>row<a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">)</a>;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">/// \brief given a row handle, get its next location</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment">/// \param[in] row_id row handle/ID</span></div><div class="line"><a name="l00850"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">  850</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> <a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">next_row_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> row_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_next_node(row_id);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">/// \brief unified interface for advancing to next augmented ID</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">/// \param[in] aug_id augmented ID</span></div><div class="line"><a name="l00856"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#af1d5b4b427c502ddbbc2cdac6d2b60ef">  856</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> <a class="code" href="classhif_1_1AugCCS.html#af1d5b4b427c502ddbbc2cdac6d2b60ef">next_aug_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> aug_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">next_row_id</a><a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">(</a>aug_id<a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">)</a>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">/// \brief given a row handle/ID, get its corresponding column index</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">/// \param[in] row_id row handle/ID</span></div><div class="line"><a name="l00862"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">  862</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> <a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">col_idx</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> row_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_ind(row_id);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="comment">/// \brief unified interface for getting primary (col) index</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">/// \param[in] aug_id augmented ID</span></div><div class="line"><a name="l00868"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a3a10a791b641bc27b8f7e143b32d4820">  868</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> <a class="code" href="classhif_1_1AugCCS.html#a3a10a791b641bc27b8f7e143b32d4820">primary_idx</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> aug_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">col_idx</a><a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">(</a>aug_id<a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">)</a>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="comment">/// \brief reserve space for nnz arrays</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="comment">/// \param[in] nnz total number of nonzeros</span></div><div class="line"><a name="l00874"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a79197ca59f2aa48102e1869a5f09a6b4">  874</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#a79197ca59f2aa48102e1869a5f09a6b4">reserve</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> nnz) {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::reserve(nnz);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::reserve(nnz);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::is_nil;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::val_pos_idx;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::ncols;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::nrows;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::row_ind;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keyword">using</span> <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::vals;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">/// \brief get the value from row handle</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">/// \param[in] row_id row handle/ID</span></div><div class="line"><a name="l00888"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a87a4baf8027e83065b3e381913f697ac">  888</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a9d0d3c3a1cc5fdbcf47b4765b1c27c75">value_type</a> <a class="code" href="classhif_1_1AugCCS.html#a87a4baf8027e83065b3e381913f697ac">val_from_row_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> row_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">return</span> vals()[val_pos_idx(row_id)];</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="comment">/// \brief unified interface for value from augmented ID</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="comment">/// \param[in] aug_id row augmented ID</span></div><div class="line"><a name="l00894"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a6e613db458427e1be655145e40c01a75">  894</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a9d0d3c3a1cc5fdbcf47b4765b1c27c75">value_type</a> <a class="code" href="classhif_1_1AugCCS.html#a6e613db458427e1be655145e40c01a75">val_from_aug_id</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> aug_id) <span class="keyword">const</span> {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a87a4baf8027e83065b3e381913f697ac">val_from_row_id</a><a class="code" href="classhif_1_1AugCCS.html#a87a4baf8027e83065b3e381913f697ac">(</a>aug_id<a class="code" href="classhif_1_1AugCCS.html#a87a4baf8027e83065b3e381913f697ac">)</a>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  }</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">/// \brief get the total number of nonzeros in row</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">/// \param[in] row row index</span></div><div class="line"><a name="l00900"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#adcf905fff05f0f99d46b48014ba80fd8">  900</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> <a class="code" href="classhif_1_1AugCCS.html#adcf905fff05f0f99d46b48014ba80fd8">nnz_in_row</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> row) <span class="keyword">const</span> {</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_nodes_in_list(row);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="comment">/// \brief unified interface for nnz in secondary direction</span></div><div class="line"><a name="l00905"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a94187dc11a30d296954ef16e06f62bcd">  905</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> <a class="code" href="classhif_1_1AugCCS.html#a94187dc11a30d296954ef16e06f62bcd">nnz_in_secondary</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> row) <span class="keyword">const</span> {</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#adcf905fff05f0f99d46b48014ba80fd8">nnz_in_row</a><a class="code" href="classhif_1_1AugCCS.html#adcf905fff05f0f99d46b48014ba80fd8">(</a>row<a class="code" href="classhif_1_1AugCCS.html#adcf905fff05f0f99d46b48014ba80fd8">)</a>;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">/// \brief interchange two rows</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="comment">/// \note This is the core operation for augmented data structure</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="comment">/// \param[in] i i-th row</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">/// \param[in] k k-th row</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">///</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">/// Mathematically, after calling this routine, the i-th and k-th rows</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">/// will be interchanged. The total complexity of this routine is linear with</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">/// respect to the total number of nonzeros in rows \a i and \a k.</span></div><div class="line"><a name="l00917"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#af6550c39c4204e5f4ac498a755306287">  917</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#af6550c39c4204e5f4ac498a755306287">interchange_rows</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> i, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> k) {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(i &lt; nrows(), <span class="stringliteral">&quot;%zd exceeds max nrows&quot;</span>, i);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(k &lt; nrows(), <span class="stringliteral">&quot;%zd exceeds max nrows&quot;</span>, k);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> (i == k) <span class="keywordflow">return</span>;  <span class="comment">// fast return</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">// get the starting handles/IDs</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> i_row_id = <a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">start_row_id</a><a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">(</a>i<a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">)</a>, k_row_id = <a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">start_row_id</a><a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">(</a>k<a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">)</a>;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="comment">// determine the emptyness</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> i_empty = is_nil(i_row_id), k_empty = is_nil(k_row_id);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="comment">// break if both are nil/empty, meaning that we have finished swapping</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordflow">if</span> (i_empty &amp;&amp; k_empty) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="comment">// get the column indices of i and k, as well as the value positions,</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="comment">// which are needed to locate the corresponding locations of the vals</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <span class="comment">// array</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> i_col = !i_empty ? <a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">col_idx</a><a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">(</a>i_row_id<a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">)</a> : <a class="code" href="classhif_1_1AugCCS.html#ac30a2fb25a405f413543e3f3efa40916">_NIL</a>;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> k_col = !k_empty ? <a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">col_idx</a><a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">(</a>k_row_id<a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">)</a> : <a class="code" href="classhif_1_1AugCCS.html#ac30a2fb25a405f413543e3f3efa40916">_NIL</a>;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> i_vp  = !i_empty ? val_pos_idx(i_row_id) : <a class="code" href="classhif_1_1AugCCS.html#ac30a2fb25a405f413543e3f3efa40916">_NIL</a>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> k_vp  = !k_empty ? val_pos_idx(k_row_id) : <a class="code" href="classhif_1_1AugCCS.html#ac30a2fb25a405f413543e3f3efa40916">_NIL</a>;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <span class="keywordflow">if</span> (i_col == k_col) {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="comment">// both columns exist</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment">// simplest case</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        std::swap(vals()[i_vp], vals()[k_vp]);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="comment">// swap the value positions as well</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_swap_val_pos_exp(i_vp, k_vp);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="comment">// advance handles</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        i_row_id = <a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">next_row_id</a><a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">(</a>i_row_id<a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">)</a>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        k_row_id = <a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">next_row_id</a><a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">(</a>k_row_id<a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">)</a>;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i_col &lt; k_col || is_nil(k_col)) {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="comment">// rotate i_col to k_col</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="comment">// get the local range of column by using standard CCS API</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="comment">// then get the positions of i-row by using the value position</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keyword">auto</span> i_row_itr_first = <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::row_ind_begin(i_col),</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;             i_row_itr_last  = <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::row_ind_end(i_col),</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;             i_row_itr_pos   = <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::row_ind().begin() + i_vp;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(std::is_sorted(i_row_itr_first, i_row_itr_last),</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                   <span class="stringliteral">&quot;%zd is not a sorted column&quot;</span>, (size_type)i_col);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="comment">// search O(log n)</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keyword">auto</span> srch_info = find_sorted(i_row_itr_first, i_row_itr_last, k);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="group__util.html#ga0925a13068fc1e31f6a7323a12a56ebf">hif_debug_code</a>(<span class="keywordtype">bool</span> k_row_should_not_exit = !srch_info.first);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(k_row_should_not_exit, <span class="stringliteral">&quot;see prefix, failed with column %zd&quot;</span>,</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                   (size_type)i_col);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="comment">// assign new row index to i-row</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        *i_row_itr_pos              = k;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span>      do_left_rot = i_row_itr_pos &lt; srch_info.second;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> n = std::abs(i_row_itr_pos - srch_info.second);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">if</span> (n) {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;          <span class="keywordflow">if</span> (do_left_rot) {</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_rotate_val_pos_left(n, i_vp);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            rotate_left(n, i_vp, row_ind());</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            rotate_left(n, i_vp, vals());</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <span class="comment">// plus 1 due to using lower_bound</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_rotate_val_pos_right(n + 1, i_vp);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            rotate_right(n + 1, i_vp, row_ind());</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            rotate_right(n + 1, i_vp, vals());</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          }</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="comment">// NOTE that the indices should maintain sorted after rotation</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <a class="code" href="group__util.html#ga0925a13068fc1e31f6a7323a12a56ebf">hif_debug_code</a>(i_row_itr_first = ccs_type::row_ind_begin(i_col);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                       i_row_itr_last  = ccs_type::row_ind_end(i_col));</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(std::is_sorted(i_row_itr_first, i_row_itr_last),</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                   <span class="stringliteral">&quot;%zd is not a sorted column (after rotation)&quot;</span>,</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                   (size_type)i_col);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">// advance i</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        i_row_id = <a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">next_row_id</a><a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">(</a>i_row_id<a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">)</a>;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="comment">// rotate k_col to i_col, exactly same as above, just change i to k</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keyword">auto</span> k_row_itr_first = <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::row_ind_begin(k_col),</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;             k_row_itr_last  = <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::row_ind_end(k_col),</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;             k_row_itr_pos   = <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::row_ind().begin() + k_vp;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(std::is_sorted(k_row_itr_first, k_row_itr_last),</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                   <span class="stringliteral">&quot;%zd is not a sorted column&quot;</span>, (size_type)k_col);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="comment">// search O(log n)</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keyword">auto</span> srch_info = find_sorted(k_row_itr_first, k_row_itr_last, i);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <a class="code" href="group__util.html#ga0925a13068fc1e31f6a7323a12a56ebf">hif_debug_code</a>(<span class="keywordtype">bool</span> i_row_should_not_exit = !srch_info.first);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(i_row_should_not_exit, <span class="stringliteral">&quot;see prefix, failed with column %zd&quot;</span>,</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                   (size_type)k_col);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="comment">// assign new row index to k-row</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        *k_row_itr_pos              = i;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span>      do_left_rot = k_row_itr_pos &lt; srch_info.second;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> n = std::abs(k_row_itr_pos - srch_info.second);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordflow">if</span> (n) {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;          <span class="keywordflow">if</span> (do_left_rot) {</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_rotate_val_pos_left(n, k_vp);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            rotate_left(n, k_vp, row_ind());</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            rotate_left(n, k_vp, vals());</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_rotate_val_pos_right(n + 1, k_vp);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            rotate_right(n + 1, k_vp, row_ind());</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            rotate_right(n + 1, k_vp, vals());</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;          }</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="comment">// NOTE that the indices should maintain sorted after rotation</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <a class="code" href="group__util.html#ga0925a13068fc1e31f6a7323a12a56ebf">hif_debug_code</a>(k_row_itr_first = ccs_type::row_ind_begin(k_col);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                       k_row_itr_last  = ccs_type::row_ind_end(k_col));</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(std::is_sorted(k_row_itr_first, k_row_itr_last),</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                   <span class="stringliteral">&quot;%zd is not a sorted column (after rotation)&quot;</span>,</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                   (size_type)k_col);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="comment">// advance k</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        k_row_id = <a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">next_row_id</a><a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">(</a>k_row_id<a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">)</a>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="comment">// finally, swap the head and tail</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_interchange_ik_head_tail(i, k);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="comment">/// \brief unified interface for interchanging</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="comment">/// \sa interchange_rows</span></div><div class="line"><a name="l01025"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a6df3e521c450097a7773396bfa77c1a5"> 1025</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#a6df3e521c450097a7773396bfa77c1a5">interchange_entries</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> i, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> k) {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#af6550c39c4204e5f4ac498a755306287">interchange_rows</a><a class="code" href="classhif_1_1AugCCS.html#af6550c39c4204e5f4ac498a755306287">(</a>i<a class="code" href="classhif_1_1AugCCS.html#af6550c39c4204e5f4ac498a755306287">,</a> k<a class="code" href="classhif_1_1AugCCS.html#af6550c39c4204e5f4ac498a755306287">)</a>;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  }</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">/// \brief defer a row to the end</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">/// \param[in] from which row to defer</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">/// \param[in] to the current pass-of-end row index</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">/// \warning the parameter \a to must be current pass-of-last row</span></div><div class="line"><a name="l01033"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#aeeb29692770db145b29adea513c00056"> 1033</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#aeeb29692770db145b29adea513c00056">defer_row</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> from, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> to) {</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(from &lt; nrows(), <span class="stringliteral">&quot;%zd exceeds max nrows&quot;</span>, from);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(to &lt; nrows(), <span class="stringliteral">&quot;%zd exceeds max nrows&quot;</span>, to);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(from &lt; to, <span class="stringliteral">&quot;from (%zd) should strictly less than to (%zd)&quot;</span>, from,</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;               to);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(is_nil(start_row_id(to)), <span class="stringliteral">&quot;destination must be empty!&quot;</span>);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">index_type</a> row_id = <a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">start_row_id</a><a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">(</a>from<a class="code" href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">)</a>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">while</span> (!is_nil(row_id)) {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> col = <a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">col_idx</a><a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">(</a>row_id<a class="code" href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">)</a>;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> vp  = val_pos_idx(row_id);</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keyword">auto</span>       itr = row_ind().begin() + vp;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <a class="code" href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a>(itr != ccs_type::row_ind_end(col), <span class="stringliteral">&quot;fatal&quot;</span>);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <span class="comment">// assign &quot;defer&quot; column index</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      *itr              = to;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> n = <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::row_ind_end(col) - itr;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      rotate_left(n, vp, row_ind());</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      rotate_left(n, vp, vals());</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_rotate_val_pos_left(n, vp);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      row_id = <a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">next_row_id</a><a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">(</a>row_id<a class="code" href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">)</a>;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    }</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">// NOTE that the start/end should not been visited, thus we can directly</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">// reuse the routine &quot;swap&quot;</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_interchange_ik_head_tail(from, to);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  }</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="comment">/// \brief unified interface for deferring</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="comment">/// \sa defer_row</span></div><div class="line"><a name="l01060"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a8d68bbd152db9f50f2e836dc2a80e5bf"> 1060</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#a8d68bbd152db9f50f2e836dc2a80e5bf">defer_entry</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> from, <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> to) {</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#aeeb29692770db145b29adea513c00056">defer_row</a><a class="code" href="classhif_1_1AugCCS.html#aeeb29692770db145b29adea513c00056">(</a>from<a class="code" href="classhif_1_1AugCCS.html#aeeb29692770db145b29adea513c00056">,</a> to<a class="code" href="classhif_1_1AugCCS.html#aeeb29692770db145b29adea513c00056">)</a>;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="comment">// utilities</span></div><div class="line"><a name="l01065"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#aa630091b9aaefbd6e0e983006e024d2b"> 1065</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCCS.html#aa630091b9aaefbd6e0e983006e024d2b">col_ind</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_inds; }</div><div class="line"><a name="l01066"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#ab0eb2a7b3b0272562502684d9a6ba3be"> 1066</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> &amp;<a class="code" href="classhif_1_1AugCCS.html#ab0eb2a7b3b0272562502684d9a6ba3be">col_ind</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_inds; }</div><div class="line"><a name="l01067"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a209d5dee243c190588b12fedcacc0733"> 1067</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCCS.html#a209d5dee243c190588b12fedcacc0733">row_start</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_start; }</div><div class="line"><a name="l01068"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#af3ea4662906940f3fcaa61f4dbedc551"> 1068</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> &amp;<a class="code" href="classhif_1_1AugCCS.html#af3ea4662906940f3fcaa61f4dbedc551">row_start</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_start; }</div><div class="line"><a name="l01069"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a2bb29bddbc7da601cb4a99b2c0826fdc"> 1069</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCCS.html#a2bb29bddbc7da601cb4a99b2c0826fdc">row_end</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_end; }</div><div class="line"><a name="l01070"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a5d2075bac22819e116e9b2431906851b"> 1070</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> *<a class="code" href="classhif_1_1AugCCS.html#a5d2075bac22819e116e9b2431906851b">row_end</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_end; }</div><div class="line"><a name="l01071"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#adf3865371b3ab5956030cb0e6b515d78"> 1071</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCCS.html#adf3865371b3ab5956030cb0e6b515d78">row_next</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_next; }</div><div class="line"><a name="l01072"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#abc83519c4bcbf64bb91e8d36df51dd0f"> 1072</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> &amp;<a class="code" href="classhif_1_1AugCCS.html#abc83519c4bcbf64bb91e8d36df51dd0f">row_next</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_next; }</div><div class="line"><a name="l01073"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#aef3362b0527196e6888a978e65b5e79a"> 1073</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> &amp;      <a class="code" href="classhif_1_1AugCCS.html#aef3362b0527196e6888a978e65b5e79a">row_counts</a>() { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_counts; }</div><div class="line"><a name="l01074"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a129818357923325e253a66d55c24ac74"> 1074</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">iarray_type</a> &amp;<a class="code" href="classhif_1_1AugCCS.html#a129818357923325e253a66d55c24ac74">row_counts</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_node_counts; }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="comment">/// \brief begin to assemble columns</span></div><div class="line"><a name="l01077"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a2eab2d2fa05ffc0cc73fe8412f54cd6c"> 1077</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#a2eab2d2fa05ffc0cc73fe8412f54cd6c">begin_assemble_cols</a>() {</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::begin_assemble_cols();</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::_begin_assemble_nodes(nrows());</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  }</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="comment">/// \brief push back a column with row indices</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="comment">/// \tparam Iter iterator type</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="comment">/// \tparam ValueArray dense value array</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="comment">/// \param[in] col current column index (C-based)</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="comment">/// \param[in] first starting iterator</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="comment">/// \param[in] last pass-of-end iterator</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="comment">/// \param[in] v dense value array, the value can be queried from indices</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Iter, <span class="keyword">class</span> ValueArray&gt;</div><div class="line"><a name="l01090"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#adf9c7b721c634bc4665e4a7c831d074f"> 1090</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#adf9c7b721c634bc4665e4a7c831d074f">push_back_col</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> col, Iter first, Iter last,</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                            <span class="keyword">const</span> ValueArray &amp;v) {</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::<span class="keyword">template</span> push_back_col&lt;Iter, ValueArray&gt;(col, first, last, v);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::<span class="keyword">template</span> _push_back_nodes&lt;Iter&gt;(col, first, last);</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">/// \brief push back a column with two lists of row indices</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">/// \tparam Iter1 iterator type</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="comment">/// \tparam ValueArray1 dense value array</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">/// \tparam Iter2 iterator type</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">/// \tparam ValueArray2 dense value array</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">/// \param[in] col current column index (c-based)</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="comment">/// \param[in] first1 starting iterator for list 1</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="comment">/// \param[in] last1 pass-of-end iterator for list 1</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="comment">/// \param[in] v1 dense value array for list 1</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="comment">/// \param[in] first2 starting iterator for list 2</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="comment">/// \param[in] last2 pass-of-end iterator for list 2</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="comment">/// \param[in] v2 dense value array for list 2</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Iter1, <span class="keyword">class</span> ValueArray1, <span class="keyword">class</span> Iter2, <span class="keyword">class</span> ValueArray2&gt;</div><div class="line"><a name="l01109"></a><span class="lineno"><a class="line" href="classhif_1_1AugCCS.html#a1c1b4010bba7ef80fe4bd7058f400009"> 1109</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classhif_1_1AugCCS.html#a1c1b4010bba7ef80fe4bd7058f400009">push_back_col</a>(<span class="keyword">const</span> <a class="code" href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">size_type</a> col, Iter1 first1, Iter1 last1,</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                            <span class="keyword">const</span> ValueArray1 &amp;v1, Iter2 first2, Iter2 last2,</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                            <span class="keyword">const</span> ValueArray2 &amp;v2) {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">ccs_type</a>::push_back_col(col, first1, last1, v1, first2, last2, v2);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::<span class="keyword">template</span> _push_back_nodes&lt;Iter1&gt;(col, first1, last1);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <a class="code" href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">_base</a>::<span class="keyword">template</span> _push_back_nodes&lt;Iter2&gt;(col, first2, last2);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;};</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;}  <span class="comment">// namespace hif</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">endif</span>  <span class="comment">// _HIF_DS_AUGMENTEDSTORAGE_HPP</span></div><div class="ttc" id="classhif_1_1AugCRS_html_ad2efedd2b5ff9fd3d71fcc02165b749e"><div class="ttname"><a href="classhif_1_1AugCRS.html#ad2efedd2b5ff9fd3d71fcc02165b749e">hif::AugCRS::col_counts</a></div><div class="ttdeci">iarray_type &amp; col_counts()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00700">AugmentedStorage.hpp:700</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a864067248afb2166f6801766e9271c09"><div class="ttname"><a href="classhif_1_1AugCCS.html#a864067248afb2166f6801766e9271c09">hif::AugCCS::build_aug</a></div><div class="ttdeci">void build_aug(const ccs_type &amp;ccs, bool clone=false)</div><div class="ttdoc">build augmented data structure based on mature CCS matrices </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00797">AugmentedStorage.hpp:797</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a6df3e521c450097a7773396bfa77c1a5"><div class="ttname"><a href="classhif_1_1AugCCS.html#a6df3e521c450097a7773396bfa77c1a5">hif::AugCCS::interchange_entries</a></div><div class="ttdeci">void interchange_entries(const size_type i, const size_type k)</div><div class="ttdoc">unified interface for interchanging </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01025">AugmentedStorage.hpp:1025</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a966fe16d1c980176407078febd4ddbd0"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a966fe16d1c980176407078febd4ddbd0">hif::internal::AugmentedCore::_node_counts</a></div><div class="ttdeci">iarray_type _node_counts</div><div class="ttdoc">number of nodes per list </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00355">AugmentedStorage.hpp:355</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_aa5920f148baf354a84de4411ed6a7e1a"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#aa5920f148baf354a84de4411ed6a7e1a">hif::internal::AugmentedCore::_node_start</a></div><div class="ttdeci">iarray_type _node_start</div><div class="ttdoc">head nodes </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00350">AugmentedStorage.hpp:350</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a8d68bbd152db9f50f2e836dc2a80e5bf"><div class="ttname"><a href="classhif_1_1AugCCS.html#a8d68bbd152db9f50f2e836dc2a80e5bf">hif::AugCCS::defer_entry</a></div><div class="ttdeci">void defer_entry(const size_type from, const size_type to)</div><div class="ttdoc">unified interface for deferring </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01060">AugmentedStorage.hpp:1060</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_abc83519c4bcbf64bb91e8d36df51dd0f"><div class="ttname"><a href="classhif_1_1AugCCS.html#abc83519c4bcbf64bb91e8d36df51dd0f">hif::AugCCS::row_next</a></div><div class="ttdeci">const iarray_type &amp; row_next() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01072">AugmentedStorage.hpp:1072</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_ad8a516b730c50b8cbb0fdabc72373146"><div class="ttname"><a href="classhif_1_1AugCRS.html#ad8a516b730c50b8cbb0fdabc72373146">hif::AugCRS::operator=</a></div><div class="ttdeci">this_type &amp; operator=(this_type &amp;&amp;)=default</div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a6217030c834990948fe8d99b62a3c6e4"><div class="ttname"><a href="classhif_1_1AugCRS.html#a6217030c834990948fe8d99b62a3c6e4">hif::AugCRS::push_back_row</a></div><div class="ttdeci">void push_back_row(const size_type row, Iter first, Iter last, const ValueArray &amp;v)</div><div class="ttdoc">push back a row with column indices </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00717">AugmentedStorage.hpp:717</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a147b276bda7bf1f4ffce2efa5b0ad680"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a147b276bda7bf1f4ffce2efa5b0ad680">hif::internal::AugmentedCore::_next_node</a></div><div class="ttdeci">index_type _next_node(const size_type nid) const</div><div class="ttdoc">get the next node ID </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00220">AugmentedStorage.hpp:220</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_aa6a7519f1cb49dc63fe2814851c936db"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#aa6a7519f1cb49dc63fe2814851c936db">hif::internal::AugmentedCore::secondary_counts</a></div><div class="ttdeci">const iarray_type &amp; secondary_counts() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00150">AugmentedStorage.hpp:150</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_aa630091b9aaefbd6e0e983006e024d2b"><div class="ttname"><a href="classhif_1_1AugCCS.html#aa630091b9aaefbd6e0e983006e024d2b">hif::AugCCS::col_ind</a></div><div class="ttdeci">iarray_type &amp; col_ind()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01065">AugmentedStorage.hpp:1065</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a99b5fcc42f9b07bc30d0fb03d449e4a7"><div class="ttname"><a href="classhif_1_1AugCCS.html#a99b5fcc42f9b07bc30d0fb03d449e4a7">hif::AugCCS::AugCCS</a></div><div class="ttdeci">AugCCS()=default</div><div class="ttdoc">default constructor </div></div>
<div class="ttc" id="namespacehif_1_1internal_html"><div class="ttname"><a href="namespacehif_1_1internal.html">hif::internal</a></div><div class="ttdef"><b>Definition:</b> <a href="factor_8hpp_source.html#l00068">factor.hpp:68</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a0147ded15994ee5a33653d410f49886b"><div class="ttname"><a href="classhif_1_1AugCCS.html#a0147ded15994ee5a33653d410f49886b">hif::AugCCS::start_row_id</a></div><div class="ttdeci">index_type start_row_id(const size_type row) const</div><div class="ttdoc">given row index, get the starting row handle/ID </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00839">AugmentedStorage.hpp:839</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_ad230b3f094510e272fc0c92a859b6aa2"><div class="ttname"><a href="classhif_1_1AugCRS.html#ad230b3f094510e272fc0c92a859b6aa2">hif::AugCRS::row_idx</a></div><div class="ttdeci">index_type row_idx(const size_type col_id) const</div><div class="ttdoc">given a column handle/ID, get its corresponding row index </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00477">AugmentedStorage.hpp:477</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_af1b7e497febdaa856e77afa78c1704da"><div class="ttname"><a href="classhif_1_1AugCCS.html#af1b7e497febdaa856e77afa78c1704da">hif::AugCCS::operator=</a></div><div class="ttdeci">this_type &amp; operator=(const this_type &amp;)=default</div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a757e3cd8244e13d271d1409fdfd0899c"><div class="ttname"><a href="classhif_1_1AugCRS.html#a757e3cd8244e13d271d1409fdfd0899c">hif::AugCRS::crs_type</a></div><div class="ttdeci">CrsType crs_type</div><div class="ttdoc">crs </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00376">AugmentedStorage.hpp:376</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a9d0d3c3a1cc5fdbcf47b4765b1c27c75"><div class="ttname"><a href="classhif_1_1AugCCS.html#a9d0d3c3a1cc5fdbcf47b4765b1c27c75">hif::AugCCS::value_type</a></div><div class="ttdeci">ccs_type::value_type value_type</div><div class="ttdoc">value </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00763">AugmentedStorage.hpp:763</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a4172df44084aa5565f87ea5c200a8392"><div class="ttname"><a href="classhif_1_1AugCCS.html#a4172df44084aa5565f87ea5c200a8392">hif::AugCCS::start_aug_id</a></div><div class="ttdeci">index_type start_aug_id(const size_type row) const</div><div class="ttdoc">unified interface for getting starting augmented ID </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00844">AugmentedStorage.hpp:844</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_ae2df2d99f1e6918c7cd364bba70e230b"><div class="ttname"><a href="classhif_1_1AugCRS.html#ae2df2d99f1e6918c7cd364bba70e230b">hif::AugCRS::size_type</a></div><div class="ttdeci">crs_type::size_type size_type</div><div class="ttdoc">size </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00378">AugmentedStorage.hpp:378</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_aa4b7297f8d0d4af7bc6faacbef493cab"><div class="ttname"><a href="classhif_1_1AugCRS.html#aa4b7297f8d0d4af7bc6faacbef493cab">hif::AugCRS::nnz_in_col</a></div><div class="ttdeci">size_type nnz_in_col(const size_type col) const</div><div class="ttdoc">get the total number of nonzeros columnwise </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00515">AugmentedStorage.hpp:515</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a36b857e8ed4b03ea5b469fced8f1045f"><div class="ttname"><a href="classhif_1_1AugCRS.html#a36b857e8ed4b03ea5b469fced8f1045f">hif::AugCRS::col_next</a></div><div class="ttdeci">const iarray_type &amp; col_next() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00699">AugmentedStorage.hpp:699</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_adedceadba809a52bfd4a959084be3bb2"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#adedceadba809a52bfd4a959084be3bb2">hif::internal::AugmentedCore::_interchange_ik_head_tail</a></div><div class="ttdeci">void _interchange_ik_head_tail(const size_type i, const size_type k)</div><div class="ttdoc">interchange the head and tail nodes given list i and k </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00306">AugmentedStorage.hpp:306</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_aeeb29692770db145b29adea513c00056"><div class="ttname"><a href="classhif_1_1AugCCS.html#aeeb29692770db145b29adea513c00056">hif::AugCCS::defer_row</a></div><div class="ttdeci">void defer_row(const size_type from, const size_type to)</div><div class="ttdoc">defer a row to the end </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01033">AugmentedStorage.hpp:1033</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_ac5db931982ad52dc4f39c291b3d9a840"><div class="ttname"><a href="classhif_1_1AugCCS.html#ac5db931982ad52dc4f39c291b3d9a840">hif::AugCCS::next_row_id</a></div><div class="ttdeci">index_type next_row_id(const size_type row_id) const</div><div class="ttdoc">given a row handle, get its next location </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00850">AugmentedStorage.hpp:850</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_acd03c489cd2b0af6d53f15b69bbe3da4"><div class="ttname"><a href="classhif_1_1AugCRS.html#acd03c489cd2b0af6d53f15b69bbe3da4">hif::AugCRS::val_from_aug_id</a></div><div class="ttdeci">value_type val_from_aug_id(const size_type aug_id) const</div><div class="ttdoc">unified interface for getting value from augmented ID </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00509">AugmentedStorage.hpp:509</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a14fded53d4e7b2b4ebda43a2420978d7"><div class="ttname"><a href="classhif_1_1AugCRS.html#a14fded53d4e7b2b4ebda43a2420978d7">hif::AugCRS::nnz_in_secondary</a></div><div class="ttdeci">size_type nnz_in_secondary(const size_type col) const</div><div class="ttdoc">unified interface for getting in secondary (col) direction </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00521">AugmentedStorage.hpp:521</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a1feec8b8c59a0643e57d58fe9fdf1790"><div class="ttname"><a href="classhif_1_1AugCCS.html#a1feec8b8c59a0643e57d58fe9fdf1790">hif::AugCCS::ccs_type</a></div><div class="ttdeci">CcsType ccs_type</div><div class="ttdoc">ccs type </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00758">AugmentedStorage.hpp:758</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_ade956f41eb20c1d9da017e1566e37314"><div class="ttname"><a href="classhif_1_1AugCRS.html#ade956f41eb20c1d9da017e1566e37314">hif::AugCRS::row_ind</a></div><div class="ttdeci">iarray_type &amp; row_ind()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00692">AugmentedStorage.hpp:692</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a7b6dc6c46490ff3b31491f15431d31d2"><div class="ttname"><a href="classhif_1_1AugCCS.html#a7b6dc6c46490ff3b31491f15431d31d2">hif::AugCCS::this_type</a></div><div class="ttdeci">AugCCS this_type</div><div class="ttdoc">this </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00757">AugmentedStorage.hpp:757</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a402d7bf3e3720838e69c6e41347275c2"><div class="ttname"><a href="classhif_1_1AugCRS.html#a402d7bf3e3720838e69c6e41347275c2">hif::AugCRS::col_start</a></div><div class="ttdeci">const iarray_type &amp; col_start() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00695">AugmentedStorage.hpp:695</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a70693b8b501896f6553abfbc96535cd2"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a70693b8b501896f6553abfbc96535cd2">hif::internal::AugmentedCore::_val_pos_inv</a></div><div class="ttdeci">iarray_type _val_pos_inv</div><div class="ttdoc">value position inverse, i.e. inv(_val_pos) </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00354">AugmentedStorage.hpp:354</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a1134da06503ae9bb478ed3a130ab01cf"><div class="ttname"><a href="classhif_1_1AugCRS.html#a1134da06503ae9bb478ed3a130ab01cf">hif::AugCRS::AugCRS</a></div><div class="ttdeci">AugCRS(const this_type &amp;other, bool clone=false)</div><div class="ttdoc">constructor to either clone or shallow copy another AugCRS </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00403">AugmentedStorage.hpp:403</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a490c1c3a8b600a4d8b79ec8f7a34b776"><div class="ttname"><a href="classhif_1_1AugCRS.html#a490c1c3a8b600a4d8b79ec8f7a34b776">hif::AugCRS::ccs_type</a></div><div class="ttdeci">crs_type::other_type ccs_type</div><div class="ttdoc">ccs </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00377">AugmentedStorage.hpp:377</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_adf3865371b3ab5956030cb0e6b515d78"><div class="ttname"><a href="classhif_1_1AugCCS.html#adf3865371b3ab5956030cb0e6b515d78">hif::AugCCS::row_next</a></div><div class="ttdeci">iarray_type &amp; row_next()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01071">AugmentedStorage.hpp:1071</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a657554b72296da31accb49b15420867f"><div class="ttname"><a href="classhif_1_1AugCRS.html#a657554b72296da31accb49b15420867f">hif::AugCRS::operator=</a></div><div class="ttdeci">this_type &amp; operator=(const this_type &amp;)=default</div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_aa47e6852c9188a601b0998906f2f2481"><div class="ttname"><a href="classhif_1_1AugCRS.html#aa47e6852c9188a601b0998906f2f2481">hif::AugCRS::iarray_type</a></div><div class="ttdeci">_base::iarray_type iarray_type</div><div class="ttdoc">index array </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00379">AugmentedStorage.hpp:379</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a1a66f5f9e0e663f3df65ae6bdd7b34ee"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a1a66f5f9e0e663f3df65ae6bdd7b34ee">hif::internal::AugmentedCore::iterator</a></div><div class="ttdeci">iarray_type::iterator iterator</div><div class="ttdoc">iterator type </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00067">AugmentedStorage.hpp:67</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_aa5dc6b2a7b2ebdcaabdd4e29f1523cde"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#aa5dc6b2a7b2ebdcaabdd4e29f1523cde">hif::internal::AugmentedCore::_node_next</a></div><div class="ttdeci">iarray_type _node_next</div><div class="ttdoc">next nodes </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00351">AugmentedStorage.hpp:351</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a6b1c56fda389e16e58345767ef67e771"><div class="ttname"><a href="classhif_1_1AugCRS.html#a6b1c56fda389e16e58345767ef67e771">hif::AugCRS::AugCRS</a></div><div class="ttdeci">AugCRS(this_type &amp;&amp;)=default</div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a2bb29bddbc7da601cb4a99b2c0826fdc"><div class="ttname"><a href="classhif_1_1AugCCS.html#a2bb29bddbc7da601cb4a99b2c0826fdc">hif::AugCCS::row_end</a></div><div class="ttdeci">iarray_type &amp; row_end()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01069">AugmentedStorage.hpp:1069</a></div></div>
<div class="ttc" id="group__util_html_ga0925a13068fc1e31f6a7323a12a56ebf"><div class="ttname"><a href="group__util.html#ga0925a13068fc1e31f6a7323a12a56ebf">hif_debug_code</a></div><div class="ttdeci">#define hif_debug_code(__code)</div><div class="ttdoc">code will only be translated on debug builds </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00221">log.hpp:221</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a7f44f4df25b1a6ca0616385489709bd2"><div class="ttname"><a href="classhif_1_1AugCCS.html#a7f44f4df25b1a6ca0616385489709bd2">hif::AugCCS::AugCCS</a></div><div class="ttdeci">AugCCS(this_type &amp;&amp;)=default</div></div>
<div class="ttc" id="group__util_html_ga9d3c0fc68115b1a021d3f3ce48d02c67"><div class="ttname"><a href="group__util.html#ga9d3c0fc68115b1a021d3f3ce48d02c67">hif_error_if</a></div><div class="ttdeci">#define hif_error_if(__cond, __msgs...)</div><div class="ttdoc">conditionally print warning message and abort </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00200">log.hpp:200</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a06cac9588b9dc9a2137fabcfd863e952"><div class="ttname"><a href="classhif_1_1AugCRS.html#a06cac9588b9dc9a2137fabcfd863e952">hif::AugCRS::ROW_MAJOR</a></div><div class="ttdeci">static constexpr bool ROW_MAJOR</div><div class="ttdoc">crs flag </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00382">AugmentedStorage.hpp:382</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_ab0eb2a7b3b0272562502684d9a6ba3be"><div class="ttname"><a href="classhif_1_1AugCCS.html#ab0eb2a7b3b0272562502684d9a6ba3be">hif::AugCCS::col_ind</a></div><div class="ttdeci">const iarray_type &amp; col_ind() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01066">AugmentedStorage.hpp:1066</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_ab5a1d953e8dab796e7c08afcc702e8c1"><div class="ttname"><a href="classhif_1_1AugCRS.html#ab5a1d953e8dab796e7c08afcc702e8c1">hif::AugCRS::interchange_cols</a></div><div class="ttdeci">void interchange_cols(const size_type i, const size_type k)</div><div class="ttdoc">interchange two columns </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00533">AugmentedStorage.hpp:533</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_ac30a2fb25a405f413543e3f3efa40916"><div class="ttname"><a href="classhif_1_1AugCCS.html#ac30a2fb25a405f413543e3f3efa40916">hif::AugCCS::_NIL</a></div><div class="ttdeci">static constexpr index_type _NIL</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00767">AugmentedStorage.hpp:767</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_aafdb24aeb9ad87bc38c34c16c6018ab0"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#aafdb24aeb9ad87bc38c34c16c6018ab0">hif::internal::AugmentedCore::val_pos_idx</a></div><div class="ttdeci">index_type val_pos_idx(const size_type nid) const</div><div class="ttdoc">given a node handle, query its value position (index) </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00126">AugmentedStorage.hpp:126</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a1ad0493c9f8c2c65491e134c3d660324"><div class="ttname"><a href="classhif_1_1AugCRS.html#a1ad0493c9f8c2c65491e134c3d660324">hif::AugCRS::_base</a></div><div class="ttdeci">internal::AugmentedCore&lt; typename CrsType::index_type &gt; _base</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00372">AugmentedStorage.hpp:372</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a92b500fcf5ad53cba72f34a0c8e94528"><div class="ttname"><a href="classhif_1_1AugCCS.html#a92b500fcf5ad53cba72f34a0c8e94528">hif::AugCCS::index_type</a></div><div class="ttdeci">iarray_type::value_type index_type</div><div class="ttdoc">index type </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00762">AugmentedStorage.hpp:762</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_af6550c39c4204e5f4ac498a755306287"><div class="ttname"><a href="classhif_1_1AugCCS.html#af6550c39c4204e5f4ac498a755306287">hif::AugCCS::interchange_rows</a></div><div class="ttdeci">void interchange_rows(const size_type i, const size_type k)</div><div class="ttdoc">interchange two rows </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00917">AugmentedStorage.hpp:917</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a1b897647f88793ea895886e8610776b8"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a1b897647f88793ea895886e8610776b8">hif::internal::AugmentedCore::AugmentedCore</a></div><div class="ttdeci">AugmentedCore(const this_type &amp;other, bool clone=false)</div><div class="ttdoc">shallow copy of clone </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00106">AugmentedStorage.hpp:106</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_ab74bc294e80634cc9bdb1c9f358448b8"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#ab74bc294e80634cc9bdb1c9f358448b8">hif::internal::AugmentedCore::secondary_end</a></div><div class="ttdeci">iarray_type &amp; secondary_end()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00147">AugmentedStorage.hpp:147</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a3719502ba6ba1219eae1616905269102"><div class="ttname"><a href="classhif_1_1AugCCS.html#a3719502ba6ba1219eae1616905269102">hif::AugCCS::size_type</a></div><div class="ttdeci">ccs_type::size_type size_type</div><div class="ttdoc">size </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00760">AugmentedStorage.hpp:760</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a6907e0a5d9199977180b766f021d0bcf"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a6907e0a5d9199977180b766f021d0bcf">hif::internal::AugmentedCore::operator=</a></div><div class="ttdeci">this_type &amp; operator=(this_type &amp;&amp;)=default</div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a5814caa9cf205fa07b26510d40719c8d"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a5814caa9cf205fa07b26510d40719c8d">hif::internal::AugmentedCore::secondary_end</a></div><div class="ttdeci">const iarray_type &amp; secondary_end() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00148">AugmentedStorage.hpp:148</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_ad711a5f12855b538ee7222d39300dc77"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#ad711a5f12855b538ee7222d39300dc77">hif::internal::AugmentedCore::_build_aug</a></div><div class="ttdeci">void _build_aug(const size_type nlist, const iarray_type &amp;ind_start, const iarray_type &amp;indices)</div><div class="ttdoc">build augmented cores based on compressed storages </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00321">AugmentedStorage.hpp:321</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a93f849ad9a18ebd578a59f4a250be638"><div class="ttname"><a href="classhif_1_1AugCCS.html#a93f849ad9a18ebd578a59f4a250be638">hif::AugCCS::iarray_type</a></div><div class="ttdeci">_base::iarray_type iarray_type</div><div class="ttdoc">index array </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00761">AugmentedStorage.hpp:761</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_adf9c7b721c634bc4665e4a7c831d074f"><div class="ttname"><a href="classhif_1_1AugCCS.html#adf9c7b721c634bc4665e4a7c831d074f">hif::AugCCS::push_back_col</a></div><div class="ttdeci">void push_back_col(const size_type col, Iter first, Iter last, const ValueArray &amp;v)</div><div class="ttdoc">push back a column with row indices </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01090">AugmentedStorage.hpp:1090</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a880653395442fe93cd78bd5f9355a421"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a880653395442fe93cd78bd5f9355a421">hif::internal::AugmentedCore::reserve</a></div><div class="ttdeci">void reserve(const size_type nnz)</div><div class="ttdoc">reserve spaces for nnz arrays </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00137">AugmentedStorage.hpp:137</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_adcf905fff05f0f99d46b48014ba80fd8"><div class="ttname"><a href="classhif_1_1AugCCS.html#adcf905fff05f0f99d46b48014ba80fd8">hif::AugCCS::nnz_in_row</a></div><div class="ttdeci">size_type nnz_in_row(const size_type row) const</div><div class="ttdoc">get the total number of nonzeros in row </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00900">AugmentedStorage.hpp:900</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a6ce7edfe63ecf5fec10bfb14b1473f4b"><div class="ttname"><a href="classhif_1_1AugCRS.html#a6ce7edfe63ecf5fec10bfb14b1473f4b">hif::AugCRS::this_type</a></div><div class="ttdeci">AugCRS this_type</div><div class="ttdoc">aug crs type </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00375">AugmentedStorage.hpp:375</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a129818357923325e253a66d55c24ac74"><div class="ttname"><a href="classhif_1_1AugCCS.html#a129818357923325e253a66d55c24ac74">hif::AugCCS::row_counts</a></div><div class="ttdeci">const iarray_type &amp; row_counts() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01074">AugmentedStorage.hpp:1074</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a5c50e7cddbeb058c679ba095e6753989"><div class="ttname"><a href="classhif_1_1AugCRS.html#a5c50e7cddbeb058c679ba095e6753989">hif::AugCRS::row_ind</a></div><div class="ttdeci">const iarray_type &amp; row_ind() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00693">AugmentedStorage.hpp:693</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a909bc75b3f24d211f4160acc66c904da"><div class="ttname"><a href="classhif_1_1AugCRS.html#a909bc75b3f24d211f4160acc66c904da">hif::AugCRS::_NIL</a></div><div class="ttdeci">static constexpr index_type _NIL</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00385">AugmentedStorage.hpp:385</a></div></div>
<div class="ttc" id="namespacehif_html"><div class="ttname"><a href="namespacehif.html">hif</a></div><div class="ttdef"><b>Definition:</b> <a href="Crout_8hpp_source.html#l00040">Crout.hpp:40</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a4f560c3f3d635b379495e601aea4441b"><div class="ttname"><a href="classhif_1_1AugCRS.html#a4f560c3f3d635b379495e601aea4441b">hif::AugCRS::AugCRS</a></div><div class="ttdeci">AugCRS(const size_type nrows, const size_type ncols, const size_type nnz=0u, bool reserve=true)</div><div class="ttdoc">constructor for general matrix </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00396">AugmentedStorage.hpp:396</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a55b0fbc8cc5e0e7e34dc0d7d306ed9b7"><div class="ttname"><a href="classhif_1_1AugCCS.html#a55b0fbc8cc5e0e7e34dc0d7d306ed9b7">hif::AugCCS::AugCCS</a></div><div class="ttdeci">AugCCS(const size_type nrows, const size_type ncols, const size_type nnz=0u, bool reserve=true)</div><div class="ttdoc">constructor for general matrices </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00778">AugmentedStorage.hpp:778</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a8dc001644c687f1f7fa5ab0ef9fdca59"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a8dc001644c687f1f7fa5ab0ef9fdca59">hif::internal::AugmentedCore::_val_pos</a></div><div class="ttdeci">iarray_type _val_pos</div><div class="ttdoc">value positions </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00353">AugmentedStorage.hpp:353</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_ade25a45dd096ce1ffc0fa6c14e101dc0"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#ade25a45dd096ce1ffc0fa6c14e101dc0">hif::internal::AugmentedCore::_NIL</a></div><div class="ttdeci">static constexpr index_type _NIL</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00070">AugmentedStorage.hpp:70</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_adaf160f87ba653581297de4bbeb4e94d"><div class="ttname"><a href="classhif_1_1AugCRS.html#adaf160f87ba653581297de4bbeb4e94d">hif::AugCRS::build_aug</a></div><div class="ttdeci">void build_aug(const ccs_type &amp;ccs)</div><div class="ttdoc">build augmented data structured based on mature CCS matrices </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00441">AugmentedStorage.hpp:441</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a9a57c0381a4cac2a24dea052157e043b"><div class="ttname"><a href="classhif_1_1AugCRS.html#a9a57c0381a4cac2a24dea052157e043b">hif::AugCRS::primary_idx</a></div><div class="ttdeci">index_type primary_idx(const size_type aug_id) const</div><div class="ttdoc">unified interface for getting primary index </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00482">AugmentedStorage.hpp:482</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html">hif::internal::AugmentedCore</a></div><div class="ttdoc">A group of forward link lists for CompressedStorage. </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00061">AugmentedStorage.hpp:61</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a117cf4913381c33a99b5f4c09ea8f9b6"><div class="ttname"><a href="classhif_1_1AugCRS.html#a117cf4913381c33a99b5f4c09ea8f9b6">hif::AugCRS::start_aug_id</a></div><div class="ttdeci">index_type start_aug_id(const size_type col) const</div><div class="ttdoc">unified interface to get starting augmented ID </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00459">AugmentedStorage.hpp:459</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a8b375e3000527d59dcb6812b119f98f5"><div class="ttname"><a href="classhif_1_1AugCRS.html#a8b375e3000527d59dcb6812b119f98f5">hif::AugCRS::index_type</a></div><div class="ttdeci">iarray_type::value_type index_type</div><div class="ttdoc">index type </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00380">AugmentedStorage.hpp:380</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a1b8c766a117a9a10c81f36990173cb4e"><div class="ttname"><a href="classhif_1_1AugCRS.html#a1b8c766a117a9a10c81f36990173cb4e">hif::AugCRS::value_type</a></div><div class="ttdeci">crs_type::value_type value_type</div><div class="ttdoc">value </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00381">AugmentedStorage.hpp:381</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a19bf4ec9c50e894d54c188795fad3ca2"><div class="ttname"><a href="classhif_1_1AugCCS.html#a19bf4ec9c50e894d54c188795fad3ca2">hif::AugCCS::crs_type</a></div><div class="ttdeci">ccs_type::other_type crs_type</div><div class="ttdoc">crs </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00759">AugmentedStorage.hpp:759</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a3a10a791b641bc27b8f7e143b32d4820"><div class="ttname"><a href="classhif_1_1AugCCS.html#a3a10a791b641bc27b8f7e143b32d4820">hif::AugCCS::primary_idx</a></div><div class="ttdeci">index_type primary_idx(const size_type aug_id) const</div><div class="ttdoc">unified interface for getting primary (col) index </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00868">AugmentedStorage.hpp:868</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a7fefc90dce79e9e6ac9a95ad7b4d70c1"><div class="ttname"><a href="classhif_1_1AugCRS.html#a7fefc90dce79e9e6ac9a95ad7b4d70c1">hif::AugCRS::col_end</a></div><div class="ttdeci">iarray_type &amp; col_end()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00696">AugmentedStorage.hpp:696</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a06d4f149c9cd53b8ee51f1651e9e161a"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a06d4f149c9cd53b8ee51f1651e9e161a">hif::internal::AugmentedCore::_node_ind</a></div><div class="ttdeci">index_type _node_ind(const size_type nid) const</div><div class="ttdoc">get node item ({col-,row-}index in aug-{ccx,crs}, correspondingly) </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00228">AugmentedStorage.hpp:228</a></div></div>
<div class="ttc" id="group__util_html_gafb95584123c5335effc5554faec5581b"><div class="ttname"><a href="group__util.html#gafb95584123c5335effc5554faec5581b">hif_assert</a></div><div class="ttdeci">#define hif_assert(__cond, __msgs...)</div><div class="ttdoc">internal debugging assertion </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00220">log.hpp:220</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a6e613db458427e1be655145e40c01a75"><div class="ttname"><a href="classhif_1_1AugCCS.html#a6e613db458427e1be655145e40c01a75">hif::AugCCS::val_from_aug_id</a></div><div class="ttdeci">value_type val_from_aug_id(const size_type aug_id) const</div><div class="ttdoc">unified interface for value from augmented ID </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00894">AugmentedStorage.hpp:894</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_aebf6c4ec5774bf7a38db33750a4edaa9"><div class="ttname"><a href="classhif_1_1AugCRS.html#aebf6c4ec5774bf7a38db33750a4edaa9">hif::AugCRS::build_aug</a></div><div class="ttdeci">void build_aug(const crs_type &amp;crs, bool clone=false)</div><div class="ttdoc">build augmented data structure based on mature CRS matrices </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00415">AugmentedStorage.hpp:415</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a144be5955d9454dfac861bfe65926b48"><div class="ttname"><a href="classhif_1_1AugCCS.html#a144be5955d9454dfac861bfe65926b48">hif::AugCCS::operator=</a></div><div class="ttdeci">this_type &amp; operator=(this_type &amp;&amp;)=default</div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_ac1216ed2b45caa57f69702738f43110f"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#ac1216ed2b45caa57f69702738f43110f">hif::internal::AugmentedCore::secondary_start</a></div><div class="ttdeci">iarray_type &amp; secondary_start()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00145">AugmentedStorage.hpp:145</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a5793ba46b48f2f75cb2c39f20e06ee99"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a5793ba46b48f2f75cb2c39f20e06ee99">hif::internal::AugmentedCore::_node_end</a></div><div class="ttdeci">iarray_type _node_end</div><div class="ttdoc">ending positions </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00352">AugmentedStorage.hpp:352</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a2478629d5942e2100112dcd0b4186213"><div class="ttname"><a href="classhif_1_1AugCRS.html#a2478629d5942e2100112dcd0b4186213">hif::AugCRS::push_back_row</a></div><div class="ttdeci">void push_back_row(const size_type row, Iter1 first1, Iter1 last1, const ValueArray1 &amp;v1, Iter2 first2, Iter2 last2, const ValueArray2 &amp;v2)</div><div class="ttdoc">push back a row with two lists of column indices </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00736">AugmentedStorage.hpp:736</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a52e4a1c93254ec6e473a2b574a2fd44b"><div class="ttname"><a href="classhif_1_1AugCRS.html#a52e4a1c93254ec6e473a2b574a2fd44b">hif::AugCRS::begin_assemble_rows</a></div><div class="ttdeci">void begin_assemble_rows()</div><div class="ttdoc">begin to assemble rows </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00704">AugmentedStorage.hpp:704</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_ace8af777b929a2316e265adfe19b6e94"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#ace8af777b929a2316e265adfe19b6e94">hif::internal::AugmentedCore::AugmentedCore</a></div><div class="ttdeci">AugmentedCore()=default</div><div class="ttdoc">default constructor </div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a5d2075bac22819e116e9b2431906851b"><div class="ttname"><a href="classhif_1_1AugCCS.html#a5d2075bac22819e116e9b2431906851b">hif::AugCCS::row_end</a></div><div class="ttdeci">const iarray_type * row_end() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01070">AugmentedStorage.hpp:1070</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a33e969242acdadf8fd2545fb7b61e203"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a33e969242acdadf8fd2545fb7b61e203">hif::internal::AugmentedCore::_swap_val_pos_exp</a></div><div class="ttdeci">void _swap_val_pos_exp(const size_type p1, const size_type p2)</div><div class="ttdoc">given two existing indices, swap them explicitly </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00238">AugmentedStorage.hpp:238</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_aef3362b0527196e6888a978e65b5e79a"><div class="ttname"><a href="classhif_1_1AugCCS.html#aef3362b0527196e6888a978e65b5e79a">hif::AugCCS::row_counts</a></div><div class="ttdeci">iarray_type &amp; row_counts()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01073">AugmentedStorage.hpp:1073</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_acbf0b6153d6ed1ef17cd56e2c8e6007a"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#acbf0b6153d6ed1ef17cd56e2c8e6007a">hif::internal::AugmentedCore::_rotate_val_pos_left</a></div><div class="ttdeci">void _rotate_val_pos_left(const size_type n, const size_type src)</div><div class="ttdoc">rotate value positions toward left </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00257">AugmentedStorage.hpp:257</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a79197ca59f2aa48102e1869a5f09a6b4"><div class="ttname"><a href="classhif_1_1AugCCS.html#a79197ca59f2aa48102e1869a5f09a6b4">hif::AugCCS::reserve</a></div><div class="ttdeci">void reserve(const size_type nnz)</div><div class="ttdoc">reserve space for nnz arrays </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00874">AugmentedStorage.hpp:874</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a94187dc11a30d296954ef16e06f62bcd"><div class="ttname"><a href="classhif_1_1AugCCS.html#a94187dc11a30d296954ef16e06f62bcd">hif::AugCCS::nnz_in_secondary</a></div><div class="ttdeci">size_type nnz_in_secondary(const size_type row) const</div><div class="ttdoc">unified interface for nnz in secondary direction </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00905">AugmentedStorage.hpp:905</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a20b60fceffbc712e547e8c6002819230"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a20b60fceffbc712e547e8c6002819230">hif::internal::AugmentedCore::_rotate_val_pos_right</a></div><div class="ttdeci">void _rotate_val_pos_right(const size_type n, const size_type src)</div><div class="ttdoc">rotate value positions toward right </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00282">AugmentedStorage.hpp:282</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a1a2fab9eda19cfe8260ee8dcf8524eed"><div class="ttname"><a href="classhif_1_1AugCCS.html#a1a2fab9eda19cfe8260ee8dcf8524eed">hif::AugCCS::build_aug</a></div><div class="ttdeci">void build_aug(const crs_type &amp;crs)</div><div class="ttdoc">build augmented data structured based on mature CRS matrices </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00825">AugmentedStorage.hpp:825</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a1c1b4010bba7ef80fe4bd7058f400009"><div class="ttname"><a href="classhif_1_1AugCCS.html#a1c1b4010bba7ef80fe4bd7058f400009">hif::AugCCS::push_back_col</a></div><div class="ttdeci">void push_back_col(const size_type col, Iter1 first1, Iter1 last1, const ValueArray1 &amp;v1, Iter2 first2, Iter2 last2, const ValueArray2 &amp;v2)</div><div class="ttdoc">push back a column with two lists of row indices </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01109">AugmentedStorage.hpp:1109</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a60a3cf39427b9113c00f40634c0130c0"><div class="ttname"><a href="classhif_1_1AugCRS.html#a60a3cf39427b9113c00f40634c0130c0">hif::AugCRS::col_end</a></div><div class="ttdeci">const iarray_type &amp; col_end() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00697">AugmentedStorage.hpp:697</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a75e1cf125c3d66d4e80bd3290272385d"><div class="ttname"><a href="classhif_1_1AugCCS.html#a75e1cf125c3d66d4e80bd3290272385d">hif::AugCCS::build_aug</a></div><div class="ttdeci">void build_aug(crs_type &amp;&amp;ccs)</div><div class="ttdoc">build augmented data structure based on mature CCS </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00811">AugmentedStorage.hpp:811</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a4e4ffb274c40098a63d5cb5d8cd49925"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a4e4ffb274c40098a63d5cb5d8cd49925">hif::internal::AugmentedCore::_start_node</a></div><div class="ttdeci">index_type _start_node(const size_type lid) const</div><div class="ttdoc">get starting node ID </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00212">AugmentedStorage.hpp:212</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a0e0f1ae065008c4b3740499e0e930fb7"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a0e0f1ae065008c4b3740499e0e930fb7">hif::internal::AugmentedCore::secondary_start</a></div><div class="ttdeci">const iarray_type &amp; secondary_start() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00146">AugmentedStorage.hpp:146</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a209d5dee243c190588b12fedcacc0733"><div class="ttname"><a href="classhif_1_1AugCCS.html#a209d5dee243c190588b12fedcacc0733">hif::AugCCS::row_start</a></div><div class="ttdeci">iarray_type &amp; row_start()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01067">AugmentedStorage.hpp:1067</a></div></div>
<div class="ttc" id="group__ds_html_ggae8ba63363282e4e9bfefc285cb31dbaba5843809d8b3589cc095aa56239f21d0d"><div class="ttname"><a href="group__ds.html#ggae8ba63363282e4e9bfefc285cb31dbaba5843809d8b3589cc095aa56239f21d0d">hif::DATA_UNDEF</a></div><div class="ttdoc">data type undefined </div><div class="ttdef"><b>Definition:</b> <a href="Array_8hpp_source.html#l00060">Array.hpp:60</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a5c2aa0655e4781cd12763cafb58498aa"><div class="ttname"><a href="classhif_1_1AugCCS.html#a5c2aa0655e4781cd12763cafb58498aa">hif::AugCCS::AugCCS</a></div><div class="ttdeci">AugCCS(const this_type &amp;other, bool clone=false)</div><div class="ttdoc">constructor to either clone or shallow copy another AugCCS </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00785">AugmentedStorage.hpp:785</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html"><div class="ttname"><a href="classhif_1_1AugCRS.html">hif::AugCRS</a></div><div class="ttdoc">Augmented CRS data structure. </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00370">AugmentedStorage.hpp:370</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_afa3f2cae684947486386ee774c710782"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#afa3f2cae684947486386ee774c710782">hif::internal::AugmentedCore::_nodes_in_list</a></div><div class="ttdeci">size_type _nodes_in_list(const size_type i) const</div><div class="ttdoc">query total number of in a certain list </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00342">AugmentedStorage.hpp:342</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a8dc42aa3cc57e17515356f8d0b5b3340"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a8dc42aa3cc57e17515356f8d0b5b3340">hif::internal::AugmentedCore::val_pos</a></div><div class="ttdeci">iarray_type &amp; val_pos()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00132">AugmentedStorage.hpp:132</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a0d0c4cd0656cfe0a8fb42249f98a8d3d"><div class="ttname"><a href="classhif_1_1AugCRS.html#a0d0c4cd0656cfe0a8fb42249f98a8d3d">hif::AugCRS::interchange_entries</a></div><div class="ttdeci">void interchange_entries(const size_type i, const size_type k)</div><div class="ttdoc">unified interface for interchanging entries </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00652">AugmentedStorage.hpp:652</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a19b98bd8b49a88052d90d92e12c4c63f"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a19b98bd8b49a88052d90d92e12c4c63f">hif::internal::AugmentedCore::_push_back_nodes</a></div><div class="ttdeci">void _push_back_nodes(const size_type entry, Iter first, Iter last)</div><div class="ttdoc">update linked lists given new nodes from back </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00178">AugmentedStorage.hpp:178</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_adb8192dcce19d2d8d65f37b1ab4680ac"><div class="ttname"><a href="classhif_1_1AugCRS.html#adb8192dcce19d2d8d65f37b1ab4680ac">hif::AugCRS::defer_col</a></div><div class="ttdeci">void defer_col(const size_type from, const size_type to)</div><div class="ttdoc">defer a column to the end </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00660">AugmentedStorage.hpp:660</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_abcf385406b6d40e2d4ca580634138e42"><div class="ttname"><a href="classhif_1_1AugCRS.html#abcf385406b6d40e2d4ca580634138e42">hif::AugCRS::defer_entry</a></div><div class="ttdeci">void defer_entry(const size_type from, const size_type to)</div><div class="ttdoc">unified interface for deferring </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00687">AugmentedStorage.hpp:687</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a393aeff4866810a09bf831cfeded2cbf"><div class="ttname"><a href="classhif_1_1AugCCS.html#a393aeff4866810a09bf831cfeded2cbf">hif::AugCCS::ROW_MAJOR</a></div><div class="ttdeci">static constexpr bool ROW_MAJOR</div><div class="ttdoc">row major flag </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00764">AugmentedStorage.hpp:764</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_accd26bafdc942d5511630ebf75ae4236"><div class="ttname"><a href="classhif_1_1AugCRS.html#accd26bafdc942d5511630ebf75ae4236">hif::AugCRS::col_next</a></div><div class="ttdeci">iarray_type &amp; col_next()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00698">AugmentedStorage.hpp:698</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html"><div class="ttname"><a href="classhif_1_1AugCCS.html">hif::AugCCS</a></div><div class="ttdoc">Augmented CCS data structure. </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00752">AugmentedStorage.hpp:752</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a69bb74a2ccb314f1151adc2b04f26e96"><div class="ttname"><a href="classhif_1_1AugCRS.html#a69bb74a2ccb314f1151adc2b04f26e96">hif::AugCRS::AugCRS</a></div><div class="ttdeci">AugCRS()=default</div><div class="ttdoc">default constructor </div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a9f05457feb06f3ba4c5935ddf1b8c7b8"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a9f05457feb06f3ba4c5935ddf1b8c7b8">hif::internal::AugmentedCore::this_type</a></div><div class="ttdeci">AugmentedCore this_type</div><div class="ttdoc">this </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00066">AugmentedStorage.hpp:66</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_ab3ab9a3f458b0087137e15333950d936"><div class="ttname"><a href="classhif_1_1AugCRS.html#ab3ab9a3f458b0087137e15333950d936">hif::AugCRS::next_aug_id</a></div><div class="ttdeci">index_type next_aug_id(const size_type aug_id) const</div><div class="ttdoc">unified interface for advancing augmented ID </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00471">AugmentedStorage.hpp:471</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_ada49787002c716114b07c23e1be5297d"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#ada49787002c716114b07c23e1be5297d">hif::internal::AugmentedCore::_node_inds</a></div><div class="ttdeci">iarray_type _node_inds</div><div class="ttdoc">indices (values) of each node </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00349">AugmentedStorage.hpp:349</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a82d2f06019abb4cf02815ef393d4f1f9"><div class="ttname"><a href="classhif_1_1AugCCS.html#a82d2f06019abb4cf02815ef393d4f1f9">hif::AugCCS::col_idx</a></div><div class="ttdeci">index_type col_idx(const size_type row_id) const</div><div class="ttdoc">given a row handle/ID, get its corresponding column index </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00862">AugmentedStorage.hpp:862</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a54cb7b45c2044f57ded2ec747101423b"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a54cb7b45c2044f57ded2ec747101423b">hif::internal::AugmentedCore::AugmentedCore</a></div><div class="ttdeci">AugmentedCore(this_type &amp;&amp;)=default</div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a9742dc6736947d3242d52ef93222ec67"><div class="ttname"><a href="classhif_1_1AugCRS.html#a9742dc6736947d3242d52ef93222ec67">hif::AugCRS::build_aug</a></div><div class="ttdeci">void build_aug(crs_type &amp;&amp;crs)</div><div class="ttdoc">build augmented data structure based on mature CRS </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00428">AugmentedStorage.hpp:428</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a0620e3e050522475412ea37c8da10c0f"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a0620e3e050522475412ea37c8da10c0f">hif::internal::AugmentedCore::AugmentedCore</a></div><div class="ttdeci">AugmentedCore(const size_type nlist, const size_type nnz=0, bool reserve=true)</div><div class="ttdoc">constructor with number of lists </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00080">AugmentedStorage.hpp:80</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_ab24fa3d0d593128dc9658b1a2fa6f690"><div class="ttname"><a href="classhif_1_1AugCRS.html#ab24fa3d0d593128dc9658b1a2fa6f690">hif::AugCRS::reserve</a></div><div class="ttdeci">void reserve(const size_type nnz)</div><div class="ttdoc">reserve space for nnz arrays </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00488">AugmentedStorage.hpp:488</a></div></div>
<div class="ttc" id="group__util_html_ga0a3c88ad06db9caf44d1a64d51ebb7b2"><div class="ttname"><a href="group__util.html#ga0a3c88ad06db9caf44d1a64d51ebb7b2">hif::error</a></div><div class="ttdeci">void error(const char *prefix, const char *file, const char *func, const unsigned line, std::string msg,...)</div><div class="ttdoc">error information streaming, dump to HIF_STDERR </div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00125">log.hpp:125</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a3222e9a7c220cddad2257acc132151fd"><div class="ttname"><a href="classhif_1_1AugCRS.html#a3222e9a7c220cddad2257acc132151fd">hif::AugCRS::val_from_col_id</a></div><div class="ttdeci">value_type val_from_col_id(const size_type col_id) const</div><div class="ttdoc">get value with col id </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00502">AugmentedStorage.hpp:502</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a1241b26612f5086b4dcf6ba0aba8f2a9"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a1241b26612f5086b4dcf6ba0aba8f2a9">hif::internal::AugmentedCore::secondary_counts</a></div><div class="ttdeci">iarray_type &amp; secondary_counts()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00149">AugmentedStorage.hpp:149</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a90a820138b5596fbfbda67c5db3a9706"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a90a820138b5596fbfbda67c5db3a9706">hif::internal::AugmentedCore::_begin_assemble_nodes</a></div><div class="ttdeci">void _begin_assemble_nodes(const size_type nlist)</div><div class="ttdoc">begin assemble nodes </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00155">AugmentedStorage.hpp:155</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a339743f850a4bc3aa20a41173c2f92ae"><div class="ttname"><a href="classhif_1_1AugCCS.html#a339743f850a4bc3aa20a41173c2f92ae">hif::AugCCS::_base</a></div><div class="ttdeci">internal::AugmentedCore&lt; typename CcsType::index_type &gt; _base</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00754">AugmentedStorage.hpp:754</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a1027719cc0533e29c494fb340bc664cc"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a1027719cc0533e29c494fb340bc664cc">hif::internal::AugmentedCore::val_pos</a></div><div class="ttdeci">const iarray_type &amp; val_pos() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00133">AugmentedStorage.hpp:133</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a83d99b27b92ed82ddc9f00a8d1bb2623"><div class="ttname"><a href="classhif_1_1AugCRS.html#a83d99b27b92ed82ddc9f00a8d1bb2623">hif::AugCRS::col_counts</a></div><div class="ttdeci">const iarray_type &amp; col_counts() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00701">AugmentedStorage.hpp:701</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a1d804c7d16688d89b8fbd6f4d4d3ddec"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a1d804c7d16688d89b8fbd6f4d4d3ddec">hif::internal::AugmentedCore::is_nil</a></div><div class="ttdeci">static constexpr bool is_nil(const index_type i)</div><div class="ttdoc">check if a given node handle is NIL or not </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00122">AugmentedStorage.hpp:122</a></div></div>
<div class="ttc" id="classhif_1_1Array_html"><div class="ttname"><a href="classhif_1_1Array.html">hif::Array</a></div><div class="ttdoc">Core data structure used in compressed storage. </div><div class="ttdef"><b>Definition:</b> <a href="Array_8hpp_source.html#l00073">Array.hpp:73</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a1297f198aef5008a62ff08721b5827c5"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a1297f198aef5008a62ff08721b5827c5">hif::internal::AugmentedCore::operator=</a></div><div class="ttdeci">this_type &amp; operator=(const this_type &amp;)=default</div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a77dfdbad4ad15fd706fd5315be37ba72"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a77dfdbad4ad15fd706fd5315be37ba72">hif::internal::AugmentedCore::iarray_type</a></div><div class="ttdeci">Array&lt; index_type &gt; iarray_type</div><div class="ttdoc">container </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00064">AugmentedStorage.hpp:64</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a2eab2d2fa05ffc0cc73fe8412f54cd6c"><div class="ttname"><a href="classhif_1_1AugCCS.html#a2eab2d2fa05ffc0cc73fe8412f54cd6c">hif::AugCCS::begin_assemble_cols</a></div><div class="ttdeci">void begin_assemble_cols()</div><div class="ttdoc">begin to assemble columns </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01077">AugmentedStorage.hpp:1077</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a8c01fd4d3fc5dbe3a26f42e51d4af8ae"><div class="ttname"><a href="classhif_1_1AugCRS.html#a8c01fd4d3fc5dbe3a26f42e51d4af8ae">hif::AugCRS::next_col_id</a></div><div class="ttdeci">index_type next_col_id(const size_type col_id) const</div><div class="ttdoc">given a column handle, get its next location </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00465">AugmentedStorage.hpp:465</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a47a4edf544aa78efe8b085aad20f8397"><div class="ttname"><a href="classhif_1_1AugCRS.html#a47a4edf544aa78efe8b085aad20f8397">hif::AugCRS::col_start</a></div><div class="ttdeci">iarray_type &amp; col_start()</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00694">AugmentedStorage.hpp:694</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_af3ea4662906940f3fcaa61f4dbedc551"><div class="ttname"><a href="classhif_1_1AugCCS.html#af3ea4662906940f3fcaa61f4dbedc551">hif::AugCCS::row_start</a></div><div class="ttdeci">const iarray_type &amp; row_start() const</div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l01068">AugmentedStorage.hpp:1068</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_af1d5b4b427c502ddbbc2cdac6d2b60ef"><div class="ttname"><a href="classhif_1_1AugCCS.html#af1d5b4b427c502ddbbc2cdac6d2b60ef">hif::AugCCS::next_aug_id</a></div><div class="ttdeci">index_type next_aug_id(const size_type aug_id) const</div><div class="ttdoc">unified interface for advancing to next augmented ID </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00856">AugmentedStorage.hpp:856</a></div></div>
<div class="ttc" id="classhif_1_1AugCRS_html_a006b32359c190acb772e68e8f44973b6"><div class="ttname"><a href="classhif_1_1AugCRS.html#a006b32359c190acb772e68e8f44973b6">hif::AugCRS::start_col_id</a></div><div class="ttdeci">index_type start_col_id(const size_type col) const</div><div class="ttdoc">given column index, get the starting column handle </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00454">AugmentedStorage.hpp:454</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a27af7dfdc7f24c5a8e8bec59758480e4"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a27af7dfdc7f24c5a8e8bec59758480e4">hif::internal::AugmentedCore::size_type</a></div><div class="ttdeci">iarray_type::size_type size_type</div><div class="ttdoc">size </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00065">AugmentedStorage.hpp:65</a></div></div>
<div class="ttc" id="classhif_1_1internal_1_1AugmentedCore_html_a1e7e50b7473e4fcf15fa61ec5293d6a3"><div class="ttname"><a href="classhif_1_1internal_1_1AugmentedCore.html#a1e7e50b7473e4fcf15fa61ec5293d6a3">hif::internal::AugmentedCore::index_type</a></div><div class="ttdeci">IndexType index_type</div><div class="ttdoc">index </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00063">AugmentedStorage.hpp:63</a></div></div>
<div class="ttc" id="classhif_1_1AugCCS_html_a87a4baf8027e83065b3e381913f697ac"><div class="ttname"><a href="classhif_1_1AugCCS.html#a87a4baf8027e83065b3e381913f697ac">hif::AugCCS::val_from_row_id</a></div><div class="ttdeci">value_type val_from_row_id(const size_type row_id) const</div><div class="ttdoc">get the value from row handle </div><div class="ttdef"><b>Definition:</b> <a href="AugmentedStorage_8hpp_source.html#l00888">AugmentedStorage.hpp:888</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b71a56306648c2ebe777f648dc45e4a5.html">hif</a></li><li class="navelem"><a class="el" href="dir_64a19d82600ce28eed97568614982d27.html">ds</a></li><li class="navelem"><a class="el" href="AugmentedStorage_8hpp.html">AugmentedStorage.hpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
